

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="封装一个通用的工具栏**目标**：封装一个通用的工具栏供大家使用 通用工具栏的组件结构 在后续的业务开发中，经常会用到一个类似下图的工具栏，作为公共组件，进行一下封装   组件 src&#x2F;components&#x2F;PageTools&#x2F;index.vue 1234567891011121314151617181920212223242526272829303132333435363738394041424">
<meta property="og:type" content="article">
<meta property="og:title" content="第八天 员工管理">
<meta property="og:url" content="http://example.com/2022/10/08/Vue-project/human-resources/08-%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="每日笔记">
<meta property="og:description" content="封装一个通用的工具栏**目标**：封装一个通用的工具栏供大家使用 通用工具栏的组件结构 在后续的业务开发中，经常会用到一个类似下图的工具栏，作为公共组件，进行一下封装   组件 src&#x2F;components&#x2F;PageTools&#x2F;index.vue 1234567891011121314151617181920212223242526272829303132333435363738394041424">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200831162222975.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200723223704401.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200917110516195.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200724001315166.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200726005308648.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20201014152302636.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200726130305221.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200901105323305.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805200831035.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805201013078.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805201230001.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805201318977.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805201422567.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805201513338.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805201750662.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805201559233.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200806135409338.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200916231600661.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200916231949174.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805211749522.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200806174643390.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200805211539544.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20201028172654637.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20201028173333103.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20201028180651472.png">
<meta property="og:image" content="http://image.zhangyc.top/img/image-20200728013006535.png">
<meta property="article:published_time" content="2022-10-07T16:00:00.000Z">
<meta property="article:modified_time" content="2022-10-16T05:50:44.415Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://image.zhangyc.top/img/image-20200831162222975.png">
  
  
  
  <title>第八天 员工管理 - 每日笔记</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="第八天 员工管理"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-10-08 00:00" pubdate>
          2022年10月8日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          87k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          724 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">第八天 员工管理</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="封装一个通用的工具栏"><a href="#封装一个通用的工具栏" class="headerlink" title="封装一个通用的工具栏"></a>封装一个通用的工具栏</h2><p>**<code>目标</code>**：封装一个通用的工具栏供大家使用</p>
<h3 id="通用工具栏的组件结构"><a href="#通用工具栏的组件结构" class="headerlink" title="通用工具栏的组件结构"></a>通用工具栏的组件结构</h3><blockquote>
<p>在后续的业务开发中，经常会用到一个类似下图的工具栏，作为公共组件，进行一下封装</p>
</blockquote>
<p><img src="http://image.zhangyc.top/img/image-20200831162222975.png" srcset="/img/loading.gif" lazyload alt="image-20200723223704401"></p>
<p>组件 <strong><code>src/components/PageTools/index.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;el-card class=&quot;page-tools&quot;&gt;<br>    &lt;el-row type=&quot;flex&quot; justify=&quot;space-between&quot; align=&quot;middle&quot;&gt;<br>      &lt;el-col&gt;<br>        &lt;div  v-if=&quot;showBefore&quot; class=&quot;before&quot;&gt;<br>          &lt;i class=&quot;el-icon-info&quot; /&gt;<br>          &lt;!-- 定义前面得插槽 --&gt;<br>          &lt;slot name=&quot;before&quot; /&gt;<br>        &lt;/div&gt;<br>      &lt;/el-col&gt;<br>      &lt;el-col&gt;<br>        &lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;<br>           &lt;!-- 定义后面的插槽 --&gt;<br>           &lt;slot name=&quot;after&quot; /&gt;<br>        &lt;/el-row&gt;<br>      &lt;/el-col&gt;<br>    &lt;/el-row&gt;<br>  &lt;/el-card&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>export default &#123;<br>  props: &#123;<br>    showBefore: &#123;<br>      type: Boolean,<br>      default: false<br>    &#125;<br><br>  &#125;<br>&#125;<br>&lt;/script&gt;<br><br>&lt;style lang=&#x27;scss&#x27;&gt;<br> .page-tools &#123;<br>    margin: 10px 0;<br>    .before &#123;<br>      line-height: 34px;<br>    i &#123;<br>      margin-right: 5px;<br>      color: #409eff;<br>    &#125;<br>    display: inline-block;<br>    padding: 0px 10px;<br>    border-radius: 3px;<br>    border: 1px solid rgba(145, 213, 255, 1);<br>    background: rgba(230, 247, 255, 1);<br>  &#125;<br> &#125;<br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure>

<h3 id="组件统一注册"><a href="#组件统一注册" class="headerlink" title="组件统一注册"></a>组件统一注册</h3><blockquote>
<p>为了方便所有的页面都可以不用引用该组件，可以进行全局注册</p>
</blockquote>
<p>提供注册入口 <strong><code>src/componets/index.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 该文件负责所有的公共的组件的全局注册   Vue.use</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">PageTools</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./PageTools&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">install</span>(<span class="hljs-params">Vue</span>) &#123;<br>    <span class="hljs-comment">//  注册全局的通用栏组件对象</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;PageTools&#x27;</span>, <span class="hljs-title class_">PageTools</span>)<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>在入口处进行注册 <strong><code>src/main.js</code></strong></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Component</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/components&#x27;</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Component</span>) <span class="hljs-comment">// 注册自己的插件</span><br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**： 封装一个通用的工具栏</p>
<h2 id="员工列表页面的基本布局和结构"><a href="#员工列表页面的基本布局和结构" class="headerlink" title="员工列表页面的基本布局和结构"></a>员工列表页面的基本布局和结构</h2><p>**<code>目标</code>**：实现员工列表页面的基本布局和结构</p>
<p><strong>结构代码</strong> <strong><code>src/employees/index.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;dashboard-container&quot;&gt;<br>    &lt;div class=&quot;app-container&quot;&gt;<br>      &lt;page-tools :show-before=&quot;true&quot;&gt;<br>        &lt;span slot=&quot;before&quot;&gt;共166条记录&lt;/span&gt;<br>        &lt;template slot=&quot;after&quot;&gt;<br>          &lt;el-button size=&quot;small&quot; type=&quot;warning&quot;&gt;导入&lt;/el-button&gt;<br>          &lt;el-button size=&quot;small&quot; type=&quot;danger&quot;&gt;导出&lt;/el-button&gt;<br>          &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;&gt;新增员工&lt;/el-button&gt;<br>        &lt;/template&gt;<br>      &lt;/page-tools&gt;<br>      &lt;!-- 放置表格和分页 --&gt;<br>      &lt;el-card&gt;<br>        &lt;el-table border&gt;<br>          &lt;el-table-column label=&quot;序号&quot; sortable=&quot;&quot; /&gt;<br>          &lt;el-table-column label=&quot;姓名&quot; sortable=&quot;&quot; /&gt;<br>          &lt;el-table-column label=&quot;工号&quot; sortable=&quot;&quot; /&gt;<br>          &lt;el-table-column label=&quot;聘用形式&quot; sortable=&quot;&quot; /&gt;<br>          &lt;el-table-column label=&quot;部门&quot; sortable=&quot;&quot; /&gt;<br>          &lt;el-table-column label=&quot;入职时间&quot; sortable=&quot;&quot; /&gt;<br>          &lt;el-table-column label=&quot;账户状态&quot; sortable=&quot;&quot; /&gt;<br>          &lt;el-table-column label=&quot;操作&quot; sortable=&quot;&quot; fixed=&quot;right&quot; width=&quot;280&quot;&gt;<br>            &lt;template&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;查看&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;转正&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;调岗&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;离职&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;角色&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;删除&lt;/el-button&gt;<br>            &lt;/template&gt;<br>          &lt;/el-table-column&gt;<br>        &lt;/el-table&gt;<br>        &lt;!-- 分页组件 --&gt;<br>        &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot; align=&quot;middle&quot; style=&quot;height: 60px&quot;&gt;<br>          &lt;el-pagination layout=&quot;prev, pager, next&quot; /&gt;<br>        &lt;/el-row&gt;<br>      &lt;/el-card&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<p><img src="http://image.zhangyc.top/img/image-20200723223704401.png" srcset="/img/loading.gif" lazyload alt="image-20200831162222975"></p>
<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**：员工列表页面的基本布局和结构</p>
<h2 id="员工列表数据请求和分页加载"><a href="#员工列表数据请求和分页加载" class="headerlink" title="员工列表数据请求和分页加载"></a>员工列表数据请求和分页加载</h2><p>**<code>目标</code>**实现员工数据的加载和分页请求</p>
<p>首先，封装员工的加载请求 <strong><code>src/api/employees.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 获取员工的综合列表数据</span><br><span class="hljs-comment"> * ***/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getEmployeeList</span>(<span class="hljs-params">params</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/sys/user&#x27;</span>,<br>    params<br>  &#125;)<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>然后，实现加载数据和分页的逻辑</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; getEmployeeList &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/employees&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,<br>      <span class="hljs-attr">list</span>: [], <span class="hljs-comment">// 接数据的</span><br>      <span class="hljs-attr">page</span>: &#123;<br>        <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// 当前页码</span><br>        <span class="hljs-attr">size</span>: <span class="hljs-number">10</span>,<br>        <span class="hljs-attr">total</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 总数</span><br>      &#125;<br><br>    &#125;<br>  &#125;,<br>  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getEmployeeList</span>()<br>  &#125;,<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-title function_">changePage</span>(<span class="hljs-params">newPage</span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>.<span class="hljs-property">page</span> = newPage<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getEmployeeList</span>()<br>    &#125;,<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getEmployeeList</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span><br>      <span class="hljs-keyword">const</span> &#123; total, rows &#125; = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEmployeeList</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>)<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>.<span class="hljs-property">total</span> = total<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">list</span> = rows<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>绑定表格</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-card v-loading=&quot;loading&quot;&gt;<br>  &lt;el-table border :data=&quot;list&quot;&gt;<br>    &lt;el-table-column label=&quot;序号&quot; sortable=&quot;&quot; type=&quot;index&quot; /&gt;<br>    &lt;el-table-column label=&quot;姓名&quot; sortable=&quot;&quot; prop=&quot;username&quot; /&gt;<br>    &lt;el-table-column label=&quot;工号&quot; sortable=&quot;&quot; prop=&quot;workNumber&quot; /&gt;<br>    &lt;el-table-column label=&quot;聘用形式&quot; sortable=&quot;&quot; prop=&quot;formOfEmployment&quot; /&gt;<br>    &lt;el-table-column label=&quot;部门&quot; sortable=&quot;&quot; prop=&quot;departmentName&quot; /&gt;<br>    &lt;el-table-column label=&quot;入职时间&quot; sortable=&quot;&quot; prop=&quot;timeOfEntry&quot; /&gt;<br>    &lt;el-table-column label=&quot;账户状态&quot; sortable=&quot;&quot; prop=&quot;enableState&quot; /&gt;<br>    &lt;el-table-column label=&quot;操作&quot; sortable=&quot;&quot; fixed=&quot;right&quot; width=&quot;280&quot;&gt;<br>      &lt;template&gt;<br>        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;查看&lt;/el-button&gt;<br>        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;转正&lt;/el-button&gt;<br>        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;调岗&lt;/el-button&gt;<br>        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;离职&lt;/el-button&gt;<br>        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;角色&lt;/el-button&gt;<br>        &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;删除&lt;/el-button&gt;<br>      &lt;/template&gt;<br>    &lt;/el-table-column&gt;<br>  &lt;/el-table&gt;<br>  &lt;!-- 分页组件 --&gt;<br>  &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot; align=&quot;middle&quot; style=&quot;height: 60px&quot;&gt;<br>    &lt;el-pagination<br>      layout=&quot;prev, pager, next&quot;<br>      :page-size=&quot;page.size&quot;<br>      :current-page=&quot;page.page&quot;<br>      :total=&quot;page.total&quot;<br>      @current-change=&quot;changePage&quot;<br>    /&gt;<br>  &lt;/el-row&gt;<br>&lt;/el-card&gt;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**员工列表数据请求和分页加载</p>
<h2 id="员工列表中的数据进行格式化"><a href="#员工列表中的数据进行格式化" class="headerlink" title="员工列表中的数据进行格式化"></a>员工列表中的数据进行格式化</h2><p>**<code>目标</code>**：将列表中的内容进行格式化</p>
<h3 id="利用列格式化属性处理聘用形式"><a href="#利用列格式化属性处理聘用形式" class="headerlink" title="利用列格式化属性处理聘用形式"></a>利用列格式化属性处理聘用形式</h3><p><img src="http://image.zhangyc.top/img/image-20200917110516195.png" srcset="/img/loading.gif" lazyload alt="image-20200724001315166"></p>
<blockquote>
<p>上小节中，列表中的<strong>聘用形式</strong>&#x2F;<strong>入职时间</strong>和<strong>账户状态</strong>需要进行显示内容的处理</p>
</blockquote>
<p>那么聘用形式中<strong>1</strong>代表什么含义，这实际上是我们需要的枚举数据，该数据的存放文件位于我们提供的**<code>资源/枚举</code><strong>中，可以将枚举下的文件夹放于</strong><code>src/api</code>**文件夹下</p>
<p>针对<strong>聘用形式</strong>，可以使用<strong>el-table-column</strong>的<strong>formatter</strong>属性进行设置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"> <span class="hljs-keyword">import</span>    <span class="hljs-title class_">EmployeeEnum</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/constant/employees&#x27;</span><br>&lt;!-- 格式化聘用形式 --&gt;<br>   <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">el-table-column</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;聘用形式&quot;</span> <span class="hljs-attr">sortable</span> <span class="hljs-attr">:formatter</span>=<span class="hljs-string">&quot;formatEmployment&quot;</span> /&gt;</span></span><br>  <span class="hljs-comment">// 格式化聘用形式</span><br>   <span class="hljs-title function_">formatEmployment</span>(<span class="hljs-params">row, column, cellValue, index</span>) &#123;<br>     <span class="hljs-comment">// 要去找 1所对应的值</span><br>     <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">EmployeeEnum</span>.<span class="hljs-property">hireType</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">id</span> === cellValue)<br>     <span class="hljs-keyword">return</span> obj ? obj.<span class="hljs-property">value</span> : <span class="hljs-string">&#x27;未知&#x27;</span><br>   &#125;<br></code></pre></td></tr></table></figure>

<h3 id="过滤器解决时间格式的处理"><a href="#过滤器解决时间格式的处理" class="headerlink" title="过滤器解决时间格式的处理"></a>过滤器解决时间格式的处理</h3><p>针对入职时间，我们可以采用<strong>作用域插槽</strong>进行处理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-table-column label=&quot;入职时间&quot; sortable prop=&quot;timeOfEntry&quot;&gt;<br>           &lt;template slot-scope=&quot;obj&quot;&gt;<br>             &#123;&#123;<br>               obj.row.timeOfEntry | 过滤器<br>             &#125;&#125;<br>           &lt;/template&gt;<br> &lt;/el-table-column&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>问题来了，过滤器从哪里呢？</p>
</blockquote>
<p>在**<code>资源/过滤器</code><strong>中，我们提供了若干工具方法，我们可以将其转化成过滤器，首先将其拷贝到</strong><code>src</code>**</p>
<p>在**<code>main.js</code>**中将工具方法转化成过滤器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> filters <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/filters&#x27;</span> <span class="hljs-comment">// 引入工具类</span><br><span class="hljs-comment">// 注册全局的过滤器</span><br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(filters).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>  <span class="hljs-comment">// 注册过滤器</span><br>  <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">filter</span>(key, filters[key])<br>&#125;)<br></code></pre></td></tr></table></figure>

<blockquote>
<p>好了，现在可以愉快的用过滤器的方式使用工具类的方法了</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-table-column label=&quot;入职时间&quot; sortable=&quot;&quot; align=&quot;center&quot;&gt;<br>     &lt;!-- 作用域插槽 --&gt;<br>     &lt;template slot-scope=&quot;&#123; row &#125;&quot;&gt;&#123;&#123; row.timeOfEntry | formatDate &#125;&#125;&lt;/template&gt;<br>&lt;/el-table-column&gt;<br></code></pre></td></tr></table></figure>

<p>最后一项，账户状态，可以用开关组件switch进行显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-table-column label=&quot;账户状态&quot; align=&quot;center&quot; sortable=&quot;&quot; prop=&quot;enableState&quot;&gt;<br>           &lt;template slot-scope=&quot;&#123; row &#125;&quot;&gt;<br>             &lt;!-- 根据当前状态来确定 是否打开开关 --&gt;<br>             &lt;el-switch :value=&quot;row.enableState === 1&quot; /&gt;<br>           &lt;/template&gt;<br>   &lt;/el-table-column&gt;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 员工列表中的数据进行格式化</p>
<h2 id="删除员工功能"><a href="#删除员工功能" class="headerlink" title="删除员工功能"></a>删除员工功能</h2><p>**<code>目标</code>**实现删除员工的功能</p>
<p>首先封装 删除员工的请求</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 删除员工接口</span><br><span class="hljs-comment"> * ****/</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">delEmployee</span>(<span class="hljs-params">id</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/sys/user/<span class="hljs-subst">$&#123;id&#125;</span>`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;delete&#x27;</span><br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>删除功能</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs vue"> &lt;template slot-scope=&quot;&#123; row &#125;&quot;&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;查看&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;转正&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;调岗&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;离职&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot;&gt;角色&lt;/el-button&gt;<br>              &lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;deleteEmployee(row.id)&quot;&gt;删除&lt;/el-button&gt;<br>            &lt;/template&gt; <br>    // 删除员工<br>    async deleteEmployee(id) &#123;<br>      try &#123;<br>        await this.$confirm(&#x27;您确定删除该员工吗&#x27;)<br>        await delEmployee(id)<br>        this.getEmployeeList()<br>        this.$message.success(&#x27;删<br>除员工成功&#x27;)<br>      &#125; catch (error) &#123;<br>        console.log(error)<br>      &#125;<br>    &#125;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**： 删除员工功能</p>
<h2 id="新增员工功能-弹层-校验-部门"><a href="#新增员工功能-弹层-校验-部门" class="headerlink" title="新增员工功能-弹层-校验-部门"></a>新增员工功能-弹层-校验-部门</h2><p>**<code>目标</code>**：实现新增员工的功能</p>
<h3 id="新建员工弹层组件"><a href="#新建员工弹层组件" class="headerlink" title="新建员工弹层组件"></a>新建员工弹层组件</h3><blockquote>
<p>当我们点击新增员工时，我们需要一个类似的弹层</p>
</blockquote>
<p><img src="http://image.zhangyc.top/img/image-20200724001315166.png" srcset="/img/loading.gif" lazyload alt="image-20200917110516195"></p>
<p>类似**<code>组织架构</code>**的组件，同样新建一个弹层组件 <strong><code>src/views/employees/components/add-employee.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;el-dialog title=&quot;新增员工&quot; :visible=&quot;showDialog&quot;&gt;<br>    &lt;!-- 表单 --&gt;<br>    &lt;el-form label-width=&quot;120px&quot;&gt;<br>      &lt;el-form-item label=&quot;姓名&quot;&gt;<br>        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请输入姓名&quot; /&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;手机&quot;&gt;<br>        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请输入手机号&quot; /&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;入职时间&quot;&gt;<br>        &lt;el-date-picker style=&quot;width:50%&quot; placeholder=&quot;请选择入职时间&quot; /&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;聘用形式&quot;&gt;<br>        &lt;el-select style=&quot;width:50%&quot; placeholder=&quot;请选择&quot; /&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;工号&quot;&gt;<br>        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请输入工号&quot; /&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;部门&quot;&gt;<br>        &lt;el-input style=&quot;width:50%&quot; placeholder=&quot;请选择部门&quot; /&gt;<br>      &lt;/el-form-item&gt;<br>      &lt;el-form-item label=&quot;转正时间&quot;&gt;<br>        &lt;el-date-picker style=&quot;width:50%&quot; placeholder=&quot;请选择转正时间&quot; /&gt;<br>      &lt;/el-form-item&gt;<br>    &lt;/el-form&gt;<br>    &lt;!-- footer插槽 --&gt;<br>    &lt;template v-slot:footer&gt;<br>      &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot;&gt;<br>        &lt;el-col :span=&quot;6&quot;&gt;<br>          &lt;el-button size=&quot;small&quot;&gt;取消&lt;/el-button&gt;<br>          &lt;el-button type=&quot;primary&quot; size=&quot;small&quot;&gt;确定&lt;/el-button&gt;<br>        &lt;/el-col&gt;<br>      &lt;/el-row&gt;<br>    &lt;/template&gt;<br>  &lt;/el-dialog&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>export default &#123;<br>  props: &#123;<br>    showDialog: &#123;<br>      type: Boolean,<br>      default: false<br>    &#125;<br>  &#125;<br>&#125;<br>&lt;/script&gt;<br><br>&lt;style&gt;<br><br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure>

<h3 id="引用弹出层，点击弹出"><a href="#引用弹出层，点击弹出" class="headerlink" title="引用弹出层，点击弹出"></a>引用弹出层，点击弹出</h3><p>父组件中引用，弹出层</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">import AddDemployee from &#x27;./components/add-employee&#x27;<br>&lt;!-- 放置新增组件 --&gt;<br> &lt;add-employee :show-dialog.sync=&quot;showDialog&quot; /&gt;<br></code></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 放置新增组件 --&gt;<br> &lt;add-employee :show-dialog.sync=&quot;showDialog&quot; /&gt;<br><br> &lt;el-button icon=&quot;plus&quot; type=&quot;primary&quot; size=&quot;small&quot; @click=&quot;showDialog = true&quot;&gt;新增员工&lt;/el-button&gt;<br><br></code></pre></td></tr></table></figure>

<h3 id="新增员工的表单校验"><a href="#新增员工的表单校验" class="headerlink" title="新增员工的表单校验"></a>新增员工的表单校验</h3><p><strong>封装新增员工</strong>api <strong><code>src/api/employees.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/** **</span><br><span class="hljs-comment"> *  新增员工的接口</span><br><span class="hljs-comment"> * **/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">addEmployee</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/sys/user&#x27;</span>,<br>    data<br>  &#125;)<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>针对员工属性，添加校验规则</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">EmployeeEnum</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/constant/employees&#x27;</span><br><br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-title class_">EmployeeEnum</span>, <span class="hljs-comment">// 在data中定义数据</span><br>      <span class="hljs-comment">// 表单数据</span><br>      <span class="hljs-attr">treeData</span>: [], <span class="hljs-comment">// 定义数组接收树形数据</span><br>      <span class="hljs-attr">showTree</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 控制树形的显示或者隐藏</span><br>      <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 控制树的显示或者隐藏进度条</span><br>      <span class="hljs-attr">formData</span>: &#123;<br>        <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">mobile</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">formOfEmployment</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">workNumber</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">departmentName</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">timeOfEntry</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">correctionTime</span>: <span class="hljs-string">&#x27;&#x27;</span><br>      &#125;,<br>      <span class="hljs-attr">rules</span>: &#123;<br>        <span class="hljs-attr">username</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;用户姓名不能为空&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;, &#123;<br>          <span class="hljs-attr">min</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;用户姓名为1-4位&#x27;</span><br>        &#125;],<br>        <span class="hljs-attr">mobile</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;手机号不能为空&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;, &#123;<br>          <span class="hljs-attr">pattern</span>: <span class="hljs-regexp">/^1[3-9]\d&#123;9&#125;$/</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;手机号格式不正确&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span><br>        &#125;],<br>        <span class="hljs-attr">formOfEmployment</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;聘用形式不能为空&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;],<br>        <span class="hljs-attr">workNumber</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;工号不能为空&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;],<br>        <span class="hljs-attr">departmentName</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;部门不能为空&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;change&#x27;</span> &#125;],<br>        <span class="hljs-attr">timeOfEntry</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;入职时间&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;]<br>      &#125;<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>绑定数据和规则校验</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-form :model=&quot;formData&quot; :rules=&quot;rules&quot; label-width=&quot;120px&quot;&gt;<br>  &lt;el-form-item label=&quot;姓名&quot; prop=&quot;username&quot;&gt;<br>    &lt;el-input v-model=&quot;formData.username&quot; style=&quot;width:50%&quot; placeholder=&quot;请输入姓名&quot; /&gt;<br>  &lt;/el-form-item&gt;<br>  &lt;el-form-item label=&quot;手机&quot; prop=&quot;mobile&quot;&gt;<br>    &lt;el-input v-model=&quot;formData.mobile&quot; style=&quot;width:50%&quot; placeholder=&quot;请输入手机号&quot; /&gt;<br>  &lt;/el-form-item&gt;<br>  &lt;el-form-item label=&quot;入职时间&quot; prop=&quot;timeOfEntry&quot;&gt;<br>    &lt;el-date-picker v-model=&quot;formData.timeOfEntry&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择日期&quot; /&gt;<br>  &lt;/el-form-item&gt;<br>  &lt;el-form-item label=&quot;聘用形式&quot; prop=&quot;formOfEmployment&quot;&gt;<br>    &lt;el-select v-model=&quot;formData.formOfEmployment&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择&quot; /&gt;<br>  &lt;/el-form-item&gt;<br>  &lt;el-form-item label=&quot;工号&quot; prop=&quot;workNumber&quot;&gt;<br>    &lt;el-input v-model=&quot;formData.workNumber&quot; style=&quot;width:50%&quot; placeholder=&quot;请输入工号&quot; /&gt;<br>  &lt;/el-form-item&gt;<br>  &lt;el-form-item label=&quot;部门&quot; prop=&quot;departmentName&quot;&gt;<br>    &lt;el-input v-model=&quot;formData.departmentName&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择部门&quot; /&gt;<br>  &lt;/el-form-item&gt;<br>  &lt;el-form-item label=&quot;转正时间&quot; prop=&quot;correctionTime&quot;&gt;<br>    &lt;el-date-picker v-model=&quot;formData.correctionTime&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择日期&quot; /&gt;<br>  &lt;/el-form-item&gt;<br>&lt;/el-form&gt;<br></code></pre></td></tr></table></figure>

<h3 id="加载部门数据转化树形"><a href="#加载部门数据转化树形" class="headerlink" title="加载部门数据转化树形"></a>加载部门数据转化树形</h3><p><strong>聘用形式和选择部门的处理</strong></p>
<blockquote>
<p> 员工的部门是从树形部门中选择一个部门</p>
</blockquote>
<p><strong>获取部门数据，转化树形</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; getDepartments &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/departments&#x27;</span><br><span class="hljs-keyword">import</span> &#123; transListToTreeData &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/utils&#x27;</span><br>  data () &#123;<br>      <span class="hljs-keyword">return</span> &#123;<br>             <span class="hljs-comment">// 表单数据</span><br>       <span class="hljs-attr">treeData</span>: [], <span class="hljs-comment">// 定义数组接收树形数据</span><br>       <span class="hljs-attr">showTree</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 控制树形的显示或者隐藏</span><br>       <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 控制树的显示或者隐藏进度条</span><br>      &#125;<br>  &#125;,<br>  <span class="hljs-attr">methods</span>: &#123;<br>      <span class="hljs-keyword">async</span> <span class="hljs-title function_">getDepartments</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">showTree</span> = <span class="hljs-literal">true</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">true</span><br>      <span class="hljs-keyword">const</span> &#123; depts &#125; = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getDepartments</span>()<br>      <span class="hljs-comment">// depts是数组 但不是树形</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">treeData</span> = <span class="hljs-title function_">transListToTreeData</span>(depts, <span class="hljs-string">&#x27;&#x27;</span>)<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">loading</span> = <span class="hljs-literal">false</span><br>    &#125;,<br>  &#125;<br></code></pre></td></tr></table></figure>

<h3 id="点击部门赋值表单数据"><a href="#点击部门赋值表单数据" class="headerlink" title="点击部门赋值表单数据"></a>点击部门赋值表单数据</h3><p><strong>选择部门，赋值表单数据</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-form-item label=&quot;部门&quot; prop=&quot;departmentName&quot;&gt;<br>        &lt;el-input v-model=&quot;formData.departmentName&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择部门&quot; @focus=&quot;getDepartments&quot; /&gt;<br>        &lt;!-- 放置一个tree组件 --&gt;<br>        &lt;el-tree<br>          v-if=&quot;showTree&quot;<br>          v-loading=&quot;loading&quot;<br>          :data=&quot;treeData&quot;<br>          default-expand-all=&quot;&quot;<br>          :props=&quot;&#123; label: &#x27;name&#x27; &#125;&quot;<br>          @node-click=&quot;selectNode&quot;<br>        /&gt;<br>      &lt;/el-form-item&gt;<br></code></pre></td></tr></table></figure>



<p><strong>点击部门时触发</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">selectNode</span>(<span class="hljs-params">node</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">departmentName</span> = node.<span class="hljs-property">name</span><br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">showTree</span> = <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>聘用形式</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-form-item label=&quot;聘用形式&quot; prop=&quot;formOfEmployment&quot;&gt;<br>    &lt;el-select v-model=&quot;formData.formOfEmployment&quot; style=&quot;width:50%&quot; placeholder=&quot;请选择&quot;&gt;<br>      &lt;!-- 遍历只能遍历组件的数据 --&gt;<br>      &lt;el-option v-for=&quot;item in EmployeeEnum.hireType&quot; :key=&quot;item.id&quot; :label=&quot;item.value&quot; :value=&quot;item.id&quot; /&gt;<br>    &lt;/el-select&gt;<br>  &lt;/el-form-item&gt;<br></code></pre></td></tr></table></figure>



<h2 id="新增员工功能-确定-取消"><a href="#新增员工功能-确定-取消" class="headerlink" title="新增员工功能-确定-取消"></a>新增员工功能-确定-取消</h2><p><strong>调用新增接口</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 点击确定时 校验整个表单</span><br><span class="hljs-keyword">async</span> <span class="hljs-title function_">btnOK</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">addEmployee</span>.<span class="hljs-title function_">validate</span>()<br>    <span class="hljs-comment">// 调用新增接口</span><br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">addEmployee</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>) <span class="hljs-comment">// 新增员工</span><br>    <span class="hljs-comment">// 告诉父组件更新数据</span><br>    <span class="hljs-comment">// this.$parent 可以直接调用到父组件的实例 实际上就是父组件this</span><br>    <span class="hljs-comment">// this.$emit</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$parent</span>.<span class="hljs-title function_">getEmployeeList</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$parent</span>.<span class="hljs-property">showDialog</span> = <span class="hljs-literal">false</span><br>  &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)<br>  &#125;<br>&#125;,<br><span class="hljs-title function_">btnCancel</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">// 重置原来的数据</span><br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span> = &#123;<br>    <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">mobile</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">formOfEmployment</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">workNumber</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">departmentName</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">timeOfEntry</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>    <span class="hljs-attr">correctionTime</span>: <span class="hljs-string">&#x27;&#x27;</span><br>  &#125;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">addEmployee</span>.<span class="hljs-title function_">resetFields</span>() <span class="hljs-comment">// 重置校验结果</span><br>  <span class="hljs-variable language_">this</span>.$emit(<span class="hljs-string">&#x27;update:showDialog&#x27;</span>, <span class="hljs-literal">false</span>)<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>新增员工的功能和组织架构的功能极其类似，这里不做过多阐述</p>
</blockquote>
<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 新增员工功能和弹层</p>
<h2 id="员工导入组件封装"><a href="#员工导入组件封装" class="headerlink" title="员工导入组件封装"></a>员工导入组件封装</h2><p>**<code>目标</code>**：封装一个导入excel数据的文件</p>
<p><img src="http://image.zhangyc.top/img/image-20200726005308648.png" srcset="/img/loading.gif" lazyload alt="image-20200726005308648"></p>
<p>首先封装一个类似的组件，首先需要注意的是，类似功能，vue-element-admin已经提供了，我们只需要改造即可 <a target="_blank" rel="noopener" href="https://github.com/PanJiaChen/vue-element-admin/blob/master/src/components/UploadExcel/index.vue">代码地址</a></p>
<blockquote>
<p>类似功能性的组件，我们只需要会使用和封装即可 </p>
</blockquote>
<p>excel导入功能需要使用npm包**<code>xlsx</code><strong>，所以需要安装</strong><code>xlsx</code>**插件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ npm i xlsx<br></code></pre></td></tr></table></figure>

<blockquote>
<p>将vue-element-admin提供的导入功能新建一个组件，位置： <strong><code>src/components/UploadExcel</code></strong></p>
</blockquote>
<p><strong>注册全局的导入excel组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">PageTools</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./PageTools&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">UploadExcel</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./UploadExcel&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">install</span>(<span class="hljs-params">Vue</span>) &#123;<br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;PageTools&#x27;</span>, <span class="hljs-title class_">PageTools</span>) <span class="hljs-comment">// 注册工具栏组件</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;UploadExcel&#x27;</span>, <span class="hljs-title class_">UploadExcel</span>) <span class="hljs-comment">// 注册导入excel组件</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>修改样式和布局</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br> &lt;div class=&quot;upload-excel&quot;&gt;<br>    &lt;div class=&quot;btn-upload&quot;&gt;<br>      &lt;el-button :loading=&quot;loading&quot; size=&quot;mini&quot; type=&quot;primary&quot; @click=&quot;handleUpload&quot;&gt;<br>        点击上传<br>      &lt;/el-button&gt;<br>    &lt;/div&gt;<br><br>    &lt;input ref=&quot;excel-upload-input&quot; class=&quot;excel-upload-input&quot; type=&quot;file&quot; accept=&quot;.xlsx, .xls&quot; @change=&quot;handleClick&quot;&gt;<br>    &lt;div class=&quot;drop&quot; @drop=&quot;handleDrop&quot; @dragover=&quot;handleDragover&quot; @dragenter=&quot;handleDragover&quot;&gt;<br>      &lt;i class=&quot;el-icon-upload&quot; /&gt;<br>      &lt;span&gt;将文件拖到此处&lt;/span&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;style scoped lang=&quot;scss&quot;&gt;<br>.upload-excel &#123;<br>  display: flex;<br>  justify-content: center;<br>   margin-top: 100px;<br>   .excel-upload-input&#123;<br>       display: none;<br>        z-index: -9999;<br>     &#125;<br>   .btn-upload , .drop&#123;<br>      border: 1px dashed #bbb;<br>      width: 350px;<br>      height: 160px;<br>      text-align: center;<br>      line-height: 160px;<br>   &#125;<br>   .drop&#123;<br>       line-height: 80px;<br>       color: #bbb;<br>      i &#123;<br>        font-size: 60px;<br>        display: block;<br>      &#125;<br>   &#125;<br>&#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**：员工导入组件封装</p>
<h2 id="员工的导入"><a href="#员工的导入" class="headerlink" title="员工的导入"></a>员工的导入</h2><p>**<code>目标</code>**：实现员工的导入</p>
<h3 id="建立公共导入的页面路由"><a href="#建立公共导入的页面路由" class="headerlink" title="建立公共导入的页面路由"></a>建立公共导入的页面路由</h3><p><strong>新建一个公共的导入页面，挂载路由</strong> <strong><code>src/router/index.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/import&#x27;</span>,<br>    <span class="hljs-attr">component</span>: <span class="hljs-title class_">Layout</span>,<br>    <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 隐藏在左侧菜单中</span><br>    <span class="hljs-attr">children</span>: [&#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 二级路由path什么都不写 表示二级默认路由</span><br>      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/import&#x27;</span>)<br>    &#125;]<br>  &#125;,<br></code></pre></td></tr></table></figure>

<p><strong>创建import路由组件</strong> <strong><code>src/views/import/index.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;!-- 公共导入组件 --&gt; <br>  &lt;upload-excel :on-success=&quot;success&quot; /&gt;<br>&lt;/template&gt;<br><br></code></pre></td></tr></table></figure>

<h3 id="分析excel导入代码，封装接口"><a href="#分析excel导入代码，封装接口" class="headerlink" title="分析excel导入代码，封装接口"></a>分析excel导入代码，封装接口</h3><blockquote>
<p>封装导入员工的api接口  </p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/** *</span><br><span class="hljs-comment"> *  封装一个导入员工的接口</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ***/</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">importEmployee</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;/sys/user/batch&#x27;</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;post&#x27;</span>,<br>    data<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="实现excel导入"><a href="#实现excel导入" class="headerlink" title="实现excel导入"></a>实现excel导入</h3><p><strong>获取导入的excel数据, 导入excel接口</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span>  <span class="hljs-title function_">success</span>(<span class="hljs-params">&#123; header, results &#125;</span>) &#123;<br>  <span class="hljs-comment">// 如果是导入员工</span><br>    <span class="hljs-keyword">const</span> userRelations = &#123;<br>      <span class="hljs-string">&#x27;入职日期&#x27;</span>: <span class="hljs-string">&#x27;timeOfEntry&#x27;</span>,<br>      <span class="hljs-string">&#x27;手机号&#x27;</span>: <span class="hljs-string">&#x27;mobile&#x27;</span>,<br>      <span class="hljs-string">&#x27;姓名&#x27;</span>: <span class="hljs-string">&#x27;username&#x27;</span>,<br>      <span class="hljs-string">&#x27;转正日期&#x27;</span>: <span class="hljs-string">&#x27;correctionTime&#x27;</span>,<br>      <span class="hljs-string">&#x27;工号&#x27;</span>: <span class="hljs-string">&#x27;workNumber&#x27;</span><br>    &#125;<br>    <span class="hljs-keyword">const</span> arr = []<br>   results.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>      <span class="hljs-keyword">const</span> userInfo = &#123;&#125;<br>      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(item).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>        userInfo[userRelations[key]] = item[key]<br>      &#125;)<br>     arr.<span class="hljs-title function_">push</span>(userInfo) <br>    &#125;)<br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">importEmployee</span>(arr) <span class="hljs-comment">// 调用导入接口</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">back</span>()<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>为了让这个页面可以服务更多的导入功能，我们可以在页面中用参数来判断，是否是导入员工</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>   <span class="hljs-keyword">return</span> &#123;<br>     <span class="hljs-attr">type</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">$route</span>.<span class="hljs-property">query</span>.<span class="hljs-property">type</span><br>   &#125;<br> &#125;,<br></code></pre></td></tr></table></figure>

<p>当excel中有日期格式的时候，实际转化的值为一个数字，我们需要一个方法进行转化</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">formatDate</span>(<span class="hljs-params">numb, format</span>) &#123;<br>  <span class="hljs-keyword">const</span> time = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>((numb - <span class="hljs-number">1</span>) * <span class="hljs-number">24</span> * <span class="hljs-number">3600000</span> + <span class="hljs-number">1</span>)<br>  time.<span class="hljs-title function_">setYear</span>(time.<span class="hljs-title function_">getFullYear</span>() - <span class="hljs-number">70</span>)<br>  <span class="hljs-keyword">const</span> year = time.<span class="hljs-title function_">getFullYear</span>() + <span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-keyword">const</span> month = time.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span> + <span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-keyword">const</span> date = time.<span class="hljs-title function_">getDate</span>() - <span class="hljs-number">1</span> + <span class="hljs-string">&#x27;&#x27;</span><br>  <span class="hljs-keyword">if</span> (format &amp;&amp; format.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-keyword">return</span> year + format + month + format + date<br>  &#125;<br>  <span class="hljs-keyword">return</span> year + (month &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + month : month) + (date &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + date : date)<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>需要注意，**<code>导入的手机号不能和之前的存在的手机号重复</code>**</p>
</blockquote>
<p><strong>逻辑判断</strong> </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span>  <span class="hljs-title function_">success</span>(<span class="hljs-params">&#123; header, results &#125;</span>) &#123;<br>     <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;user&#x27;</span>) &#123;<br>       <span class="hljs-keyword">const</span> userRelations = &#123;<br>         <span class="hljs-string">&#x27;入职日期&#x27;</span>: <span class="hljs-string">&#x27;timeOfEntry&#x27;</span>,<br>         <span class="hljs-string">&#x27;手机号&#x27;</span>: <span class="hljs-string">&#x27;mobile&#x27;</span>,<br>         <span class="hljs-string">&#x27;姓名&#x27;</span>: <span class="hljs-string">&#x27;username&#x27;</span>,<br>         <span class="hljs-string">&#x27;转正日期&#x27;</span>: <span class="hljs-string">&#x27;correctionTime&#x27;</span>,<br>         <span class="hljs-string">&#x27;工号&#x27;</span>: <span class="hljs-string">&#x27;workNumber&#x27;</span><br>       &#125;<br>       <span class="hljs-keyword">const</span> arr = []<br>       <span class="hljs-comment">// 遍历所有的数组</span><br>       results.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>       <span class="hljs-comment">// 需要将每一个条数据里面的中文都换成英文</span><br>         <span class="hljs-keyword">const</span> userInfo = &#123;&#125;<br>         <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(item).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>         <span class="hljs-comment">// key是当前的中文名 找到对应的英文名</span><br>           <span class="hljs-keyword">if</span> (userRelations[key] === <span class="hljs-string">&#x27;timeOfEntry&#x27;</span> || userRelations[key] === <span class="hljs-string">&#x27;correctionTime&#x27;</span>) &#123;<br>             userInfo[userRelations[key]] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatDate</span>(item[key], <span class="hljs-string">&#x27;/&#x27;</span>)) <span class="hljs-comment">// 只有这样, 才能入库</span><br>             <span class="hljs-keyword">return</span><br>           &#125;<br>           userInfo[userRelations[key]] = item[key]<br>         &#125;)<br>         <span class="hljs-comment">// 最终userInfo变成了全是英文</span><br>         arr.<span class="hljs-title function_">push</span>(userInfo)<br>       &#125;)<br>       <span class="hljs-keyword">await</span> <span class="hljs-title function_">importEmployee</span>(arr)<br>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;导入成功&#x27;</span>)<br>     &#125;<br>     <span class="hljs-variable language_">this</span>.<span class="hljs-property">$router</span>.<span class="hljs-title function_">back</span>() <span class="hljs-comment">// 回到上一页</span><br>   &#125;,<br>   <span class="hljs-title function_">formatDate</span>(<span class="hljs-params">numb, format</span>) &#123;<br>     <span class="hljs-keyword">const</span> time = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>((numb - <span class="hljs-number">1</span>) * <span class="hljs-number">24</span> * <span class="hljs-number">3600000</span> + <span class="hljs-number">1</span>)<br>     time.<span class="hljs-title function_">setYear</span>(time.<span class="hljs-title function_">getFullYear</span>() - <span class="hljs-number">70</span>)<br>     <span class="hljs-keyword">const</span> year = time.<span class="hljs-title function_">getFullYear</span>() + <span class="hljs-string">&#x27;&#x27;</span><br>     <span class="hljs-keyword">const</span> month = time.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span> + <span class="hljs-string">&#x27;&#x27;</span><br>     <span class="hljs-keyword">const</span> date = time.<span class="hljs-title function_">getDate</span>() - <span class="hljs-number">1</span> + <span class="hljs-string">&#x27;&#x27;</span><br>     <span class="hljs-keyword">if</span> (format &amp;&amp; format.<span class="hljs-property">length</span> === <span class="hljs-number">1</span>) &#123;<br>       <span class="hljs-keyword">return</span> year + format + month + format + date<br>     &#125;<br>     <span class="hljs-keyword">return</span> year + (month &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + month : month) + (date &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">&#x27;0&#x27;</span> + date : date)<br>   &#125;<br></code></pre></td></tr></table></figure>

<p><strong>员工页面跳转</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-button type=&quot;warning&quot; size=&quot;small&quot; @click=&quot;$router.push(&#x27;/import?type=user&#x27;)&quot;&gt;导入&lt;/el-button&gt;<br><br></code></pre></td></tr></table></figure>

<p>**<code>目标</code>**： 实现员工的导入</p>
<h2 id="员工导出excel功能"><a href="#员工导出excel功能" class="headerlink" title="员工导出excel功能"></a>员工导出excel功能</h2><p><strong>目标</strong>： 实现将员工数据导出功能</p>
<blockquote>
<p>日常业务中，我们经常遇到excel导出功能， 怎么使用呢</p>
</blockquote>
<p>Excel 的导入导出都是依赖于<a target="_blank" rel="noopener" href="https://github.com/SheetJS/js-xlsx">js-xlsx</a>来实现的。</p>
<p>在 <code>js-xlsx</code>的基础上又封装了<a target="_blank" rel="noopener" href="https://github.com/PanJiaChen/vue-element-admin/blob/master/src/vendor/Export2Excel.js">Export2Excel.js</a>来方便导出数据。</p>
<h3 id="安装excel所需依赖和按需加载"><a href="#安装excel所需依赖和按需加载" class="headerlink" title="安装excel所需依赖和按需加载"></a>安装excel所需依赖和按需加载</h3><p>由于 <code>Export2Excel</code>不仅依赖<code>js-xlsx</code>还依赖<code>file-saver</code>和<code>script-loader</code>。</p>
<p>所以你先需要安装如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install xlsx file-saver -S<br>npm install script-loader -S -D<br></code></pre></td></tr></table></figure>

<p>由于<code>js-xlsx</code>体积还是很大的，导出功能也不是一个非常常用的功能，所以使用的时候建议使用懒加载。使用方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/vendor/Export2Excel&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">excel</span> =&gt;</span> &#123;<br>  excel.<span class="hljs-title function_">export_json_to_excel</span>(&#123;<br>    <span class="hljs-attr">header</span>: tHeader, <span class="hljs-comment">//表头 必填</span><br>    data, <span class="hljs-comment">//具体数据 必填</span><br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;excel-list&#x27;</span>, <span class="hljs-comment">//非必填</span><br>    <span class="hljs-attr">autoWidth</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//非必填</span><br>    <span class="hljs-attr">bookType</span>: <span class="hljs-string">&#x27;xlsx&#x27;</span> <span class="hljs-comment">//非必填</span><br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure>

<h3 id="excel导出参数的介绍"><a href="#excel导出参数的介绍" class="headerlink" title="excel导出参数的介绍"></a>excel导出参数的介绍</h3><blockquote>
<p>vue-element-admin提供了导出的功能模块，在课程资源&#x2F;excel导出目录下，放置到src目录下</p>
</blockquote>
<p><strong>参数</strong></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>类型</th>
<th>可选值</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>header</td>
<td>导出数据的表头</td>
<td>Array</td>
<td>&#x2F;</td>
<td>[]</td>
</tr>
<tr>
<td>data</td>
<td>导出的具体数据</td>
<td>Array</td>
<td>&#x2F;</td>
<td>[[]]</td>
</tr>
<tr>
<td>filename</td>
<td>导出文件名</td>
<td>String</td>
<td>&#x2F;</td>
<td>excel-list</td>
</tr>
<tr>
<td>autoWidth</td>
<td>单元格是否要自适应宽度</td>
<td>Boolean</td>
<td>true &#x2F; false</td>
<td>true</td>
</tr>
<tr>
<td>bookType</td>
<td>导出文件类型</td>
<td>String</td>
<td>xlsx, csv, txt, <a target="_blank" rel="noopener" href="https://github.com/SheetJS/js-xlsx#supported-output-formats">more</a></td>
<td>xlsx</td>
</tr>
</tbody></table>
<h3 id="excel导出基本的结构"><a href="#excel导出基本的结构" class="headerlink" title="excel导出基本的结构"></a>excel导出基本的结构</h3><blockquote>
<p>我们最重要的一件事，就是把表头和数据进行相应的对应</p>
</blockquote>
<p>因为数据中的key是英文，想要导出的表头是中文的话，需要将中文和英文做对应</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> headers = &#123;<br>     <span class="hljs-string">&#x27;手机号&#x27;</span>: <span class="hljs-string">&#x27;mobile&#x27;</span>,<br>     <span class="hljs-string">&#x27;姓名&#x27;</span>: <span class="hljs-string">&#x27;username&#x27;</span>,<br>     <span class="hljs-string">&#x27;入职日期&#x27;</span>: <span class="hljs-string">&#x27;timeOfEntry&#x27;</span>,<br>     <span class="hljs-string">&#x27;聘用形式&#x27;</span>: <span class="hljs-string">&#x27;formOfEmployment&#x27;</span>,<br>     <span class="hljs-string">&#x27;转正日期&#x27;</span>: <span class="hljs-string">&#x27;correctionTime&#x27;</span>,<br>     <span class="hljs-string">&#x27;工号&#x27;</span>: <span class="hljs-string">&#x27;workNumber&#x27;</span>,<br>     <span class="hljs-string">&#x27;部门&#x27;</span>: <span class="hljs-string">&#x27;departmentName&#x27;</span><br>   &#125;<br></code></pre></td></tr></table></figure>

<p>然后，<strong>完成导出代码</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 导出excel数据</span><br><span class="hljs-title function_">exportData</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-comment">//  做操作</span><br>  <span class="hljs-comment">// 表头对应关系</span><br>  <span class="hljs-keyword">const</span> headers = &#123;<br>    <span class="hljs-string">&#x27;姓名&#x27;</span>: <span class="hljs-string">&#x27;username&#x27;</span>,<br>    <span class="hljs-string">&#x27;手机号&#x27;</span>: <span class="hljs-string">&#x27;mobile&#x27;</span>,<br>    <span class="hljs-string">&#x27;入职日期&#x27;</span>: <span class="hljs-string">&#x27;timeOfEntry&#x27;</span>,<br>    <span class="hljs-string">&#x27;聘用形式&#x27;</span>: <span class="hljs-string">&#x27;formOfEmployment&#x27;</span>,<br>    <span class="hljs-string">&#x27;转正日期&#x27;</span>: <span class="hljs-string">&#x27;correctionTime&#x27;</span>,<br>    <span class="hljs-string">&#x27;工号&#x27;</span>: <span class="hljs-string">&#x27;workNumber&#x27;</span>,<br>    <span class="hljs-string">&#x27;部门&#x27;</span>: <span class="hljs-string">&#x27;departmentName&#x27;</span><br>  &#125;<br>  <span class="hljs-comment">// 懒加载</span><br>  <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/vendor/Export2Excel&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> excel =&gt; &#123;<br>    <span class="hljs-keyword">const</span> &#123; rows &#125; = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEmployeeList</span>(&#123; <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">size</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>.<span class="hljs-property">total</span> &#125;)<br>    <span class="hljs-keyword">const</span> data = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatJson</span>(headers, rows)<br><br>    excel.<span class="hljs-title function_">export_json_to_excel</span>(&#123;<br>      <span class="hljs-attr">header</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers),<br>      data,<br>      <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;员工信息表&#x27;</span>,<br>      <span class="hljs-attr">autoWidth</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">bookType</span>: <span class="hljs-string">&#x27;xlsx&#x27;</span><br><br>    &#125;)<br>    <span class="hljs-comment">// 获取所有的数据</span><br><br>    <span class="hljs-comment">// excel.export_json_to_excel(&#123;</span><br>    <span class="hljs-comment">//   header: [&#x27;姓名&#x27;, &#x27;薪资&#x27;],</span><br>    <span class="hljs-comment">//   data: [[&#x27;张三&#x27;, 12000], [&#x27;李四&#x27;, 5000]],</span><br>    <span class="hljs-comment">//   filename: &#x27;员工薪资表&#x27;,</span><br>    <span class="hljs-comment">//   autoWidth: true,</span><br>    <span class="hljs-comment">//   bookType: &#x27;csv&#x27;</span><br>    <span class="hljs-comment">// &#125;)</span><br>  &#125;)<br>&#125;,<br><span class="hljs-comment">// 该方法负责将数组转化成二维数组</span><br><span class="hljs-title function_">formatJson</span>(<span class="hljs-params">headers, rows</span>) &#123;<br>  <span class="hljs-comment">// 首先遍历数组</span><br>  <span class="hljs-comment">// [&#123; username: &#x27;张三&#x27;&#125;,&#123;&#125;,&#123;&#125;]  =&gt; [[’张三&#x27;],[],[]]</span><br>  <span class="hljs-keyword">return</span> rows.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>      <span class="hljs-keyword">if</span> (headers[key] === <span class="hljs-string">&#x27;timeOfEntry&#x27;</span> || headers[key] === <span class="hljs-string">&#x27;correctionTime&#x27;</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatDate</span>(item[headers[key]]) <span class="hljs-comment">// 返回格式化之前的时间</span><br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (headers[key] === <span class="hljs-string">&#x27;formOfEmployment&#x27;</span>) &#123;<br>        <span class="hljs-keyword">var</span> en = <span class="hljs-title class_">EmployeeEnum</span>.<span class="hljs-property">hireType</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> obj.<span class="hljs-property">id</span> === item[headers[key]])<br>        <span class="hljs-keyword">return</span> en ? en.<span class="hljs-property">value</span> : <span class="hljs-string">&#x27;未知&#x27;</span><br>      &#125;<br>      <span class="hljs-keyword">return</span> item[headers[key]]<br>    &#125;) <span class="hljs-comment">// =&gt; [&quot;张三&quot;, &quot;13811&quot;，&quot;2018&quot;,&quot;1&quot;, &quot;2018&quot;, &quot;10002&quot;]</span><br>  &#125;)<br>  <span class="hljs-comment">// return data</span><br>  <span class="hljs-comment">// return rows.map(item =&gt; &#123;</span><br>  <span class="hljs-comment">//   // item是对象  =&gt; 转化成只有值的数组 =&gt; 数组值的顺序依赖headers  &#123;username: &#x27;张三&#x27;  &#125;</span><br>  <span class="hljs-comment">//   // Object.keys(headers)  =&gt; [&quot;姓名&quot;, &quot;手机号&quot;,...]</span><br>  <span class="hljs-comment">//   return Object.keys(headers).map(key =&gt; &#123;</span><br>  <span class="hljs-comment">//     return item[headers[key]]</span><br>  <span class="hljs-comment">//   &#125;) // /  得到 [&#x27;张三&#x27;，’129‘，’dd‘,&#x27;dd&#x27;]</span><br>  <span class="hljs-comment">// &#125;)</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="导出时间格式的处理"><a href="#导出时间格式的处理" class="headerlink" title="导出时间格式的处理"></a>导出时间格式的处理</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">formatJson</span>(<span class="hljs-params">headers, rows</span>) &#123;<br>  <span class="hljs-keyword">return</span> rows.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>    <span class="hljs-comment">// item是一个对象  &#123; mobile: 132111,username: &#x27;张三&#x27;  &#125;</span><br>    <span class="hljs-comment">// [&quot;手机号&quot;, &quot;姓名&quot;, &quot;入职日期&quot; 。。]</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>      <span class="hljs-comment">// 需要判断 字段</span><br>      <span class="hljs-keyword">if</span> (headers[key] === <span class="hljs-string">&#x27;timeOfEntry&#x27;</span> || headers[key] === <span class="hljs-string">&#x27;correctionTime&#x27;</span>) &#123;<br>        <span class="hljs-comment">// 格式化日期</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatDate</span>(item[headers[key]])<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (headers[key] === <span class="hljs-string">&#x27;formOfEmployment&#x27;</span>) &#123;<br>        <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">EmployeeEnum</span>.<span class="hljs-property">hireType</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> obj.<span class="hljs-property">id</span> === item[headers[key]])<br>        <span class="hljs-keyword">return</span> obj ? obj.<span class="hljs-property">value</span> : <span class="hljs-string">&#x27;未知&#x27;</span><br>      &#125;<br>      <span class="hljs-keyword">return</span> item[headers[key]]<br>    &#125;)<br>    <span class="hljs-comment">// [&quot;132&quot;, &#x27;张三’， ‘’，‘’，‘’d]</span><br>  &#125;)<br>  <span class="hljs-comment">// return rows.map(item =&gt; Object.keys(headers).map(key =&gt; item[headers[key]]))</span><br>  <span class="hljs-comment">// 需要处理时间格式问题</span><br>&#125;<br></code></pre></td></tr></table></figure>



<h3 id="扩展-复杂表头的导出"><a href="#扩展-复杂表头的导出" class="headerlink" title="扩展  复杂表头的导出"></a><strong><code>扩展</code></strong>  复杂表头的导出</h3><blockquote>
<p>当需要导出复杂表头的时候，vue-element-admin同样支持该类操作</p>
</blockquote>
<p><strong>vue-element-admin</strong> 提供的导出方法中有 <strong>multiHeader</strong>和<strong>merges</strong> 的参数</p>
<table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>类型</th>
<th>可选值</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>multiHeader</td>
<td>复杂表头的部分</td>
<td>Array</td>
<td>&#x2F;</td>
<td>[[]]</td>
</tr>
<tr>
<td>merges</td>
<td>需要合并的部分</td>
<td>Array</td>
<td>&#x2F;</td>
<td>[]</td>
</tr>
</tbody></table>
<p>multiHeader里面是一个二维数组，里面的一个元素是一行表头，假设你想得到一个如图的结构</p>
<p><img src="http://image.zhangyc.top/img/image-20201014152302636.png" srcset="/img/loading.gif" lazyload alt="image-20201014152302636"></p>
<p>mutiHeader应该这样定义</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> multiHeader = [[<span class="hljs-string">&#x27;姓名&#x27;</span>, <span class="hljs-string">&#x27;主要信息&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;部门&#x27;</span>]]<br></code></pre></td></tr></table></figure>

<p>multiHeader中的一行表头中的字段的个数需要和真正的列数相等，假设想要跨列，多余的空间需要定义成空串</p>
<p>它主要对应的是标准的表头</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> header = [<span class="hljs-string">&#x27;姓名&#x27;</span>, <span class="hljs-string">&#x27;手机号&#x27;</span>, <span class="hljs-string">&#x27;入职日期&#x27;</span>, <span class="hljs-string">&#x27;聘用形式&#x27;</span>, <span class="hljs-string">&#x27;转正日期&#x27;</span>, <span class="hljs-string">&#x27;工号&#x27;</span>, <span class="hljs-string">&#x27;部门&#x27;</span>]<br></code></pre></td></tr></table></figure>

<p>如果，我们要实现其合并的效果， 需要设定merges选项</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> merges = [<span class="hljs-string">&#x27;A1:A2&#x27;</span>, <span class="hljs-string">&#x27;B1:F1&#x27;</span>, <span class="hljs-string">&#x27;G1:G2&#x27;</span>]<br></code></pre></td></tr></table></figure>

<p>merges的顺序是没关系的，只要配置这两个属性，就可以导出复杂表头的excel了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">exportData</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">const</span> headers = &#123;<br>      <span class="hljs-string">&#x27;姓名&#x27;</span>: <span class="hljs-string">&#x27;username&#x27;</span>,<br>      <span class="hljs-string">&#x27;手机号&#x27;</span>: <span class="hljs-string">&#x27;mobile&#x27;</span>,<br>      <span class="hljs-string">&#x27;入职日期&#x27;</span>: <span class="hljs-string">&#x27;timeOfEntry&#x27;</span>,<br>      <span class="hljs-string">&#x27;聘用形式&#x27;</span>: <span class="hljs-string">&#x27;formOfEmployment&#x27;</span>,<br>      <span class="hljs-string">&#x27;转正日期&#x27;</span>: <span class="hljs-string">&#x27;correctionTime&#x27;</span>,<br>      <span class="hljs-string">&#x27;工号&#x27;</span>: <span class="hljs-string">&#x27;workNumber&#x27;</span>,<br>      <span class="hljs-string">&#x27;部门&#x27;</span>: <span class="hljs-string">&#x27;departmentName&#x27;</span><br>    &#125;<br>    <span class="hljs-comment">// 导出excel</span><br>    <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/vendor/Export2Excel&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> excel =&gt; &#123;<br>      <span class="hljs-comment">//  excel是引入文件的导出对象</span><br>      <span class="hljs-comment">// 导出  header从哪里来</span><br>      <span class="hljs-comment">// data从哪里来</span><br>      <span class="hljs-comment">// 现在没有一个接口获取所有的数据</span><br>      <span class="hljs-comment">// 获取员工的接口 页码 每页条数    100   1 10000</span><br>      <span class="hljs-keyword">const</span> &#123; rows &#125; = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEmployeeList</span>(&#123; <span class="hljs-attr">page</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">size</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>.<span class="hljs-property">total</span> &#125;)<br>      <span class="hljs-keyword">const</span> data = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">formatJson</span>(headers, rows) <span class="hljs-comment">// 返回的data就是 要导出的结构</span><br>      <span class="hljs-keyword">const</span> multiHeader = [[<span class="hljs-string">&#x27;姓名&#x27;</span>, <span class="hljs-string">&#x27;主要信息&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;部门&#x27;</span>]]<br>      <span class="hljs-keyword">const</span> merges = [<span class="hljs-string">&#x27;A1:A2&#x27;</span>, <span class="hljs-string">&#x27;B1:F1&#x27;</span>, <span class="hljs-string">&#x27;G1:G2&#x27;</span>]<br>      excel.<span class="hljs-title function_">export_json_to_excel</span>(&#123;<br>        <span class="hljs-attr">header</span>: <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers),<br>        data,<br>        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;员工资料表&#x27;</span>,<br>        multiHeader, <span class="hljs-comment">// 复杂表头</span><br>        merges <span class="hljs-comment">// 合并选项</span><br>      &#125;)<br><br>      <span class="hljs-comment">// excel.export_json_to_excel(&#123;</span><br>      <span class="hljs-comment">//   header: [&#x27;姓名&#x27;, &#x27;工资&#x27;],</span><br>      <span class="hljs-comment">//   data: [[&#x27;张三&#x27;, 3000], [&#x27;李四&#x27;, 5000]],</span><br>      <span class="hljs-comment">//   filename: &#x27;员工工资表&#x27;</span><br>      <span class="hljs-comment">// &#125;)</span><br>      <span class="hljs-comment">// [&#123; username: &#x27;张三&#x27;,mobile: 13112345678 &#125;]  =&gt; [[]]</span><br>      <span class="hljs-comment">// 要转化 数据结构 还要和表头的顺序对应上</span><br>      <span class="hljs-comment">// 要求转出的标题是中文</span><br>    &#125;)<br>  &#125;,<br>  <span class="hljs-comment">// 将表头数据和数据进行对应</span><br>  <span class="hljs-comment">// [&#123;&#125;]  =&gt;   [[]]</span><br>  <span class="hljs-title function_">formatJson</span>(<span class="hljs-params">headers, rows</span>) &#123;<br>    <span class="hljs-keyword">return</span> rows.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>      <span class="hljs-comment">// item是一个对象  &#123; mobile: 132111,username: &#x27;张三&#x27;  &#125;</span><br>      <span class="hljs-comment">// [&quot;手机号&quot;, &quot;姓名&quot;, &quot;入职日期&quot; 。。]</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(headers).<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>        <span class="hljs-comment">// 需要判断 字段</span><br>        <span class="hljs-keyword">if</span> (headers[key] === <span class="hljs-string">&#x27;timeOfEntry&#x27;</span> || headers[key] === <span class="hljs-string">&#x27;correctionTime&#x27;</span>) &#123;<br>          <span class="hljs-comment">// 格式化日期</span><br>          <span class="hljs-keyword">return</span> <span class="hljs-title function_">formatDate</span>(item[headers[key]])<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (headers[key] === <span class="hljs-string">&#x27;formOfEmployment&#x27;</span>) &#123;<br>          <span class="hljs-keyword">const</span> obj = <span class="hljs-title class_">EmployeeEnum</span>.<span class="hljs-property">hireType</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">obj</span> =&gt;</span> obj.<span class="hljs-property">id</span> === item[headers[key]])<br>          <span class="hljs-keyword">return</span> obj ? obj.<span class="hljs-property">value</span> : <span class="hljs-string">&#x27;未知&#x27;</span><br>        &#125;<br>        <span class="hljs-keyword">return</span> item[headers[key]]<br>      &#125;)<br>      <span class="hljs-comment">// [&quot;132&quot;, &#x27;张三’， ‘’，‘’，‘’d]</span><br>    &#125;)<br>    <span class="hljs-comment">// return rows.map(item =&gt; Object.keys(headers).map(key =&gt; item[headers[key]]))</span><br>    <span class="hljs-comment">// 需要处理时间格式问题</span><br>  &#125;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**实现将员工数据导出功能</p>
<h2 id="员工详情页创建和布局"><a href="#员工详情页创建和布局" class="headerlink" title="员工详情页创建和布局"></a>员工详情页创建和布局</h2><p>**<code>目标</code>**：创建员工详情的主要布局页面和基本布局</p>
<h3 id="详情页的基本布局和路由"><a href="#详情页的基本布局和路由" class="headerlink" title="详情页的基本布局和路由"></a>详情页的基本布局和路由</h3><p><img src="http://image.zhangyc.top/img/image-20200726130305221.png" srcset="/img/loading.gif" lazyload alt="image-20200726130305221"></p>
<p><strong>建立详情页路由</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;detail/:id&#x27;</span>, <span class="hljs-comment">// query传参 动态路由传参</span><br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/employees/detail&#x27;</span>),<br>    <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 不在左侧菜单显示</span><br>    <span class="hljs-attr">meta</span>: &#123;<br>      <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;员工详情&#x27;</span> <span class="hljs-comment">// 标记当前路由规则的中文名称 后续在做左侧菜单时 使用</span><br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<p><strong>建立基本架构</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;div class=&quot;dashboard-container&quot;&gt;<br>    &lt;div class=&quot;app-container&quot;&gt;<br>      &lt;el-card&gt;<br>        &lt;el-tabs&gt;<br>          &lt;el-tab-pane label=&quot;登录账户设置&quot;&gt;<br><br>            &lt;!-- 放置表单 --&gt;<br>            &lt;el-form label-width=&quot;120px&quot; style=&quot;margin-left: 120px; margin-top:30px&quot;&gt;<br>              &lt;el-form-item label=&quot;姓名:&quot;&gt;<br>                &lt;el-input style=&quot;width:300px&quot; /&gt;<br>              &lt;/el-form-item&gt;<br>              &lt;el-form-item label=&quot;密码:&quot;&gt;<br>                &lt;el-input style=&quot;width:300px&quot; type=&quot;password&quot; /&gt;<br>              &lt;/el-form-item&gt;<br>              &lt;el-form-item&gt;<br>                &lt;el-button type=&quot;primary&quot;&gt;更新&lt;/el-button&gt;<br>              &lt;/el-form-item&gt;<br>            &lt;/el-form&gt;<br>          &lt;/el-tab-pane&gt;<br>          &lt;el-tab-pane label=&quot;个人详情&quot; /&gt;<br>          &lt;el-tab-pane label=&quot;岗位信息&quot; /&gt;<br>        &lt;/el-tabs&gt;<br>      &lt;/el-card&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br></code></pre></td></tr></table></figure>

<p><strong>列表跳转到详情</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;$router.push(`/employees/detail/$&#123;obj.row.id&#125;`)&quot;&gt;查看&lt;/el-button&gt;<br><br></code></pre></td></tr></table></figure>

<h3 id="读取和保存用户信息的接口"><a href="#读取和保存用户信息的接口" class="headerlink" title="读取和保存用户信息的接口"></a>读取和保存用户信息的接口</h3><p><strong>加载个人基本信息</strong> &gt; 该接口已经在之前提供过了 <strong><code>src/api/user.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/** *</span><br><span class="hljs-comment"> *  获取某个用户的基本信息</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ***/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getUserDetailById</span>(<span class="hljs-params">id</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/sys/user/<span class="hljs-subst">$&#123;id&#125;</span>`</span><br>  &#125;)<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><strong>保存个人基本信息</strong>  <strong><code>src/api/employees.js</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/** *</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 保存员工的基本信息</span><br><span class="hljs-comment"> * **/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">saveUserDetailById</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/sys/user/<span class="hljs-subst">$&#123;data.id&#125;</span>`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;put&#x27;</span>,<br>    data<br>  &#125;)<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="实现用户名和密码的修改"><a href="#实现用户名和密码的修改" class="headerlink" title="实现用户名和密码的修改"></a>实现用户名和密码的修改</h3><p><strong><code>注意</code><strong>：这里有个缺陷，接口中读取的是后端的密文，我们并不能解密，所以当我们没有任何修改就保存时，会校验失败，因为密文超过了规定的12位长度，为了真的修改密码，我们设定了一个临时的字段 <strong>password2</strong>，用它来存储我们的修改值，最后保存的时候，把</strong>password2</strong>传给<strong>password</strong></p>
<p><strong>用户名和密码的修改</strong>  <strong><code>src/views/employees/detail.vue</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; getUserDetailById &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/user&#x27;</span><br><span class="hljs-keyword">import</span> &#123; saveUserDetailById &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/employees&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">userId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">$route</span>.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>, <span class="hljs-comment">// 这样可以后面直接通过 this.userId进行获取数据</span><br>      <span class="hljs-attr">userInfo</span>: &#123;<br>        <span class="hljs-comment">//   专门存放基本信息</span><br>        <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">password2</span>: <span class="hljs-string">&#x27;&#x27;</span><br>      &#125;,<br>      <span class="hljs-attr">rules</span>: &#123;<br>        <span class="hljs-attr">username</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;姓名不能为空&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;],<br>        <span class="hljs-attr">password2</span>: [&#123; <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;密码不能为空&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;,<br>          &#123; <span class="hljs-attr">min</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">9</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&#x27;密码长度6-9位&#x27;</span>, <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;blur&#x27;</span> &#125;]<br>      &#125;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUserDetailById</span>()<br>  &#125;,<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserDetailById</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserDetailById</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span>)<br>    &#125;,<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">saveUser</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">try</span> &#123;<br>        <span class="hljs-comment">// 校验</span><br>        <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">userForm</span>.<span class="hljs-title function_">validate</span>()<br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">saveUserDetailById</span>(&#123; ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span>, <span class="hljs-attr">password</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span>.<span class="hljs-property">password2</span> &#125;) <span class="hljs-comment">// 将新密码的值替换原密码的值</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;保存成功&#x27;</span>)<br>      &#125; <span class="hljs-keyword">catch</span> (error) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(error)<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>绑定表单数据</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 放置表单 --&gt;<br>           &lt;el-form ref=&quot;userForm&quot; :model=&quot;userInfo&quot; :rules=&quot;rules&quot; label-width=&quot;120px&quot; style=&quot;margin-left: 120px; margin-top:30px&quot;&gt;<br>             &lt;el-form-item label=&quot;姓名:&quot; prop=&quot;username&quot;&gt;<br>               &lt;el-input v-model=&quot;userInfo.username&quot; style=&quot;width:300px&quot; /&gt;<br>             &lt;/el-form-item&gt;<br>             &lt;el-form-item label=&quot;新密码:&quot; prop=&quot;password2&quot;&gt;<br>               &lt;el-input v-model=&quot;userInfo.password2&quot; style=&quot;width:300px&quot; type=&quot;password&quot; /&gt;<br>             &lt;/el-form-item&gt;<br>             &lt;el-form-item&gt;<br>               &lt;el-button type=&quot;primary&quot; @click=&quot;saveUser&quot;&gt;更新&lt;/el-button&gt;<br>             &lt;/el-form-item&gt;<br>           &lt;/el-form&gt;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<h2 id="个人组件和岗位组件封装"><a href="#个人组件和岗位组件封装" class="headerlink" title="个人组件和岗位组件封装"></a>个人组件和岗位组件封装</h2><h3 id="封装个人详情组件"><a href="#封装个人详情组件" class="headerlink" title="封装个人详情组件"></a>封装个人详情组件</h3><blockquote>
<p>我们将员工个人信息分为三部分，账户，个人， 岗位，这个小节我们对个人组件和岗位组件进行封装</p>
</blockquote>
<p><img src="http://image.zhangyc.top/img/image-20200901105323305.png" srcset="/img/loading.gif" lazyload alt="image-20200901105323305"></p>
<p><strong>封装个人组件</strong>   <strong><code>src/views/employees/components/user-info.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;user-info&quot;&gt;<br>    &lt;!-- 个人信息 --&gt;<br>    &lt;el-form label-width=&quot;220px&quot;&gt;<br>      &lt;!-- 工号 入职时间 --&gt;<br>      &lt;el-row class=&quot;inline-info&quot;&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-form-item label=&quot;工号&quot;&gt;<br>            &lt;el-input v-model=&quot;userInfo.workNumber&quot; class=&quot;inputW&quot; /&gt;<br>          &lt;/el-form-item&gt;<br>        &lt;/el-col&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-form-item label=&quot;入职时间&quot;&gt;<br>            &lt;el-date-picker<br>              v-model=&quot;userInfo.timeOfEntry&quot;<br>              type=&quot;date&quot;<br>              class=&quot;inputW&quot;<br>              value-format=&quot;YYYY-MM-DD&quot;<br>            /&gt;<br>          &lt;/el-form-item&gt;<br>        &lt;/el-col&gt;<br>      &lt;/el-row&gt;<br>      &lt;!-- 姓名 部门 --&gt;<br>      &lt;el-row class=&quot;inline-info&quot;&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-form-item label=&quot;姓名&quot;&gt;<br>            &lt;el-input v-model=&quot;userInfo.username&quot; class=&quot;inputW&quot; /&gt;<br>          &lt;/el-form-item&gt;<br>        &lt;/el-col&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-form-item label=&quot;部门&quot;&gt;<br>            &lt;el-input v-model=&quot;userInfo.departmentName&quot; class=&quot;inputW&quot; /&gt;<br>          &lt;/el-form-item&gt;<br>        &lt;/el-col&gt;<br>      &lt;/el-row&gt;<br>      &lt;!--手机 聘用形式  --&gt;<br>      &lt;el-row class=&quot;inline-info&quot;&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-form-item label=&quot;手机&quot;&gt;<br>            &lt;el-input v-model=&quot;userInfo.mobile&quot; /&gt;<br>          &lt;/el-form-item&gt;<br>        &lt;/el-col&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-form-item label=&quot;聘用形式&quot;&gt;<br>            &lt;el-select v-model=&quot;userInfo.formOfEmployment&quot; class=&quot;inputW&quot;&gt;<br>              &lt;el-option<br>                v-for=&quot;item in EmployeeEnum.hireType&quot;<br>                :key=&quot;item.id&quot;<br>                :label=&quot;item.value&quot;<br>                :value=&quot;item.id&quot;<br>              /&gt;<br>            &lt;/el-select&gt;<br>          &lt;/el-form-item&gt;<br>        &lt;/el-col&gt;<br>      &lt;/el-row&gt;<br>      &lt;!-- 员工照片 --&gt;<br>      &lt;el-row class=&quot;inline-info&quot;&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-form-item label=&quot;员工头像&quot;&gt;<br>            &lt;!-- 放置上传图片 --&gt;<br>           <br>          &lt;/el-form-item&gt;<br>        &lt;/el-col&gt;<br>      &lt;/el-row&gt;<br>      &lt;!-- 保存个人信息 --&gt;<br>      &lt;el-row class=&quot;inline-info&quot; type=&quot;flex&quot; justify=&quot;center&quot;&gt;<br>        &lt;el-col :span=&quot;12&quot;&gt;<br>          &lt;el-button type=&quot;primary&quot; @click=&quot;saveUser&quot;&gt;保存更新&lt;/el-button&gt;<br>          &lt;el-button @click=&quot;$router.back()&quot;&gt;返回&lt;/el-button&gt;<br><br>        &lt;/el-col&gt;<br>      &lt;/el-row&gt;<br>    &lt;/el-form&gt;<br>    &lt;!-- 基础信息 --&gt;<br>    &lt;el-form label-width=&quot;220px&quot;&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;基础信息&lt;/div&gt;<br>        &lt;el-form-item label=&quot;最高学历&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.theHighestDegreeOfEducation&quot; class=&quot;inputW2&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.highestDegree&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;!-- 个人头像 --&gt;<br>        &lt;!-- 员工照片 --&gt;<br><br>        &lt;el-form-item label=&quot;员工照片&quot;&gt;<br>          &lt;!-- 放置上传图片 --&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;国家/地区&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.nationalArea&quot; class=&quot;inputW2&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.isOverseas&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;护照号&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.passportNo&quot; placeholder=&quot;正规护照格式&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;身份证号&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.idNumber&quot; placeholder=&quot;正规身份证格式&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;籍贯&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.nativePlace&quot; placeholder=&quot;籍贯地址&quot; class=&quot;inputW5&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;民族&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.nation&quot; placeholder=&quot;请输入民族&quot; class=&quot;inputW2&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;婚姻状况&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.maritalStatus&quot; class=&quot;inputW2&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.maritaStatus&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;生日&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.birthday&quot; placeholder=&quot;示例 0323&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;年龄&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.age&quot; type=&quot;number&quot; class=&quot;inputW2&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;星座&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.constellation&quot; class=&quot;inputW2&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.constellation&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;血型&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.bloodType&quot; class=&quot;inputW2&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.bloodType&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;户籍所在地&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.domicile&quot; class=&quot;inputW5&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;政治面貌&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.politicalOutlook&quot; class=&quot;inputW2&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;入党时间&quot;&gt;<br>          &lt;el-date-picker<br>            v-model=&quot;formData.timeToJoinTheParty&quot;<br>            type=&quot;date&quot;<br>            placeholder=&quot;选择日期&quot;<br>            class=&quot;inputW&quot;<br>            value-format=&quot;yyyy-MM-dd&quot;<br>          /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;存档机构&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.archivingOrganization&quot; placeholder=&quot;请输入&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;子女状态&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.stateOfChildren&quot; placeholder=&quot;请输入&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;子女有无商业险&quot;&gt;<br>          &lt;el-radio-group v-model=&quot;formData.doChildrenHaveCommercialInsurance&quot;&gt;<br>            &lt;el-radio label=&quot;1&quot;&gt;有&lt;/el-radio&gt;<br>            &lt;el-radio label=&quot;2&quot;&gt;无&lt;/el-radio&gt;<br>          &lt;/el-radio-group&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;有无违法违纪状态&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.isThereAnyViolationOfLawOrDiscipline&quot; placeholder=&quot;请输入&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;有无重大病史&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.areThereAnyMajorMedicalHistories&quot; placeholder=&quot;请输入&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/div&gt;<br>      &lt;!-- 通讯信息 --&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;通讯信息&lt;/div&gt;<br>        &lt;el-form-item label=&quot;QQ&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.qq&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;微信&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.wechat&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;现居住地&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.placeOfResidence&quot; placeholder=&quot;请输入&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;通讯地址&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.postalAddress&quot; placeholder=&quot;请输入&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;联系手机&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.contactTheMobilePhone&quot; placeholder=&quot;11位字符&quot; maxlength=&quot;11&quot; class=&quot;inputW&quot; @change.native=&quot;handlePhone(2)&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;个人邮箱&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.personalMailbox&quot; placeholder=&quot;请输入&quot; type=&quot;mail&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;紧急联系人&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.emergencyContact&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;紧急联系电话&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.emergencyContactNumber&quot; placeholder=&quot;11位字符&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/div&gt;<br>      &lt;!-- 账号信息 --&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;账号信息&lt;/div&gt;<br>        &lt;el-form-item label=&quot;社保电脑号&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.socialSecurityComputerNumber&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;公积金账号&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.providentFundAccount&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;银行卡号&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.bankCardNumber&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;开户行&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.openingBank&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/div&gt;<br>      &lt;!-- 教育信息 --&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;教育信息&lt;/div&gt;<br>        &lt;el-form-item label=&quot;学历类型&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.educationalType&quot; placeholder=&quot;请选择&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.educationType&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;毕业学校&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.graduateSchool&quot; placeholder=&quot;请输入&quot; class=&quot;inputW2&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;入学时间&quot;&gt;<br>          &lt;el-date-picker v-model=&quot;formData.enrolmentTime&quot; type=&quot;data&quot; placeholder=&quot;请输入时间&quot; class=&quot;inputW&quot; value-format=&quot;yyyy-MM-dd&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;毕业时间&quot;&gt;<br>          &lt;el-date-picker v-model=&quot;formData.graduationTime&quot; type=&quot;data&quot; placeholder=&quot;请输入时间&quot; class=&quot;inputW&quot; value-format=&quot;yyyy-MM-dd&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;专业&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.major&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/div&gt;<br>      &lt;!-- 从业信息 --&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;从业信息&lt;/div&gt;<br>        &lt;el-form-item label=&quot;上家公司&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.homeCompany&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;职称&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.title&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;有无竞业限制&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.isThereAnyCompetitionRestriction&quot; placeholder=&quot;请输入&quot; style=&quot;width:80%&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;备注&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.remarks&quot; type=&quot;textarea&quot; placeholder=&quot;请输入备注&quot; style=&quot;width:80%&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;!-- 保存员工信息 --&gt;<br>        &lt;el-row class=&quot;inline-info&quot; type=&quot;flex&quot; justify=&quot;center&quot;&gt;<br>          &lt;el-col :span=&quot;12&quot;&gt;<br>            &lt;el-button type=&quot;primary&quot; @click=&quot;savePersonal&quot;&gt;保存更新&lt;/el-button&gt;<br>            &lt;el-button @click=&quot;$router.back()&quot;&gt;返回&lt;/el-button&gt;<br>          &lt;/el-col&gt;<br>        &lt;/el-row&gt;<br>      &lt;/div&gt;<br>    &lt;/el-form&gt;<br><br>  &lt;/div&gt;<br><br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>本章节个人数据过于**<code>繁杂，庞大</code>**，同学们在开发期间，拷贝代码即可，我们只写关键部位的代码</p>
</blockquote>
<p><strong>定义user-info的数据</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">EmployeeEnum</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/constant/employees&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">userId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">$route</span>.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>,<br>      <span class="hljs-title class_">EmployeeEnum</span>, <span class="hljs-comment">// 员工枚举数据</span><br>      <span class="hljs-attr">userInfo</span>: &#123;&#125;,<br>      <span class="hljs-attr">formData</span>: &#123;<br>        <span class="hljs-attr">userId</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">username</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 用户名</span><br>        <span class="hljs-attr">sex</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 性别</span><br>        <span class="hljs-attr">mobile</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 手机</span><br>        <span class="hljs-attr">companyId</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 公司id</span><br>        <span class="hljs-attr">departmentName</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 部门名称</span><br>        <span class="hljs-comment">//  onTheJobStatus: &#x27;&#x27;, // 在职状态 no</span><br>        <span class="hljs-attr">dateOfBirth</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 出生日期</span><br>        <span class="hljs-attr">timeOfEntry</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 入职时间</span><br>        <span class="hljs-attr">theHighestDegreeOfEducation</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 最高学历</span><br>        <span class="hljs-attr">nationalArea</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 国家</span><br>        <span class="hljs-attr">passportNo</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 护照号</span><br>        <span class="hljs-attr">idNumber</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 身份证号</span><br>        <span class="hljs-attr">idCardPhotoPositive</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 身份证照正</span><br>        <span class="hljs-attr">idCardPhotoBack</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 身份证照正</span><br>        <span class="hljs-attr">nativePlace</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 籍贯</span><br>        <span class="hljs-attr">nation</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 民族</span><br>        <span class="hljs-attr">englishName</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 英文名字</span><br>        <span class="hljs-attr">maritalStatus</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 婚姻状况</span><br>        <span class="hljs-attr">staffPhoto</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 员工照片</span><br>        <span class="hljs-attr">birthday</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 生日</span><br>        <span class="hljs-attr">zodiac</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 属相</span><br>        <span class="hljs-attr">age</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 年龄</span><br>        <span class="hljs-attr">constellation</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 星座</span><br>        <span class="hljs-attr">bloodType</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 血型</span><br>        <span class="hljs-attr">domicile</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 户籍所在地</span><br>        <span class="hljs-attr">politicalOutlook</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 政治面貌</span><br>        <span class="hljs-attr">timeToJoinTheParty</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 入党时间</span><br>        <span class="hljs-attr">archivingOrganization</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 存档机构</span><br>        <span class="hljs-attr">stateOfChildren</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 子女状态</span><br>        <span class="hljs-attr">doChildrenHaveCommercialInsurance</span>: <span class="hljs-string">&#x27;1&#x27;</span>, <span class="hljs-comment">// 保险状态</span><br>        <span class="hljs-attr">isThereAnyViolationOfLawOrDiscipline</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 违法违纪状态</span><br>        <span class="hljs-attr">areThereAnyMajorMedicalHistories</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 重大病史</span><br>        <span class="hljs-attr">qq</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// QQ</span><br>        <span class="hljs-attr">wechat</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 微信</span><br>        <span class="hljs-attr">residenceCardCity</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 居住证城市</span><br>        <span class="hljs-attr">dateOfResidencePermit</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 居住证办理日期</span><br>        <span class="hljs-attr">residencePermitDeadline</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 居住证截止日期</span><br>        <span class="hljs-attr">placeOfResidence</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 现居住地</span><br>        <span class="hljs-attr">postalAddress</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 通讯地址</span><br>        <span class="hljs-attr">contactTheMobilePhone</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 联系手机</span><br>        <span class="hljs-attr">personalMailbox</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 个人邮箱</span><br>        <span class="hljs-attr">emergencyContact</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 紧急联系人</span><br>        <span class="hljs-attr">emergencyContactNumber</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 紧急联系电话</span><br>        <span class="hljs-attr">socialSecurityComputerNumber</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 社保电脑号</span><br>        <span class="hljs-attr">providentFundAccount</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 公积金账号</span><br>        <span class="hljs-attr">bankCardNumber</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 银行卡号</span><br>        <span class="hljs-attr">openingBank</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 开户行</span><br>        <span class="hljs-attr">educationalType</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 学历类型</span><br>        <span class="hljs-attr">graduateSchool</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 毕业学校</span><br>        <span class="hljs-attr">enrolmentTime</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 入学时间</span><br>        <span class="hljs-attr">graduationTime</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 毕业时间</span><br>        <span class="hljs-attr">major</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 专业</span><br>        <span class="hljs-attr">graduationCertificate</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 毕业证书</span><br>        <span class="hljs-attr">certificateOfAcademicDegree</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 学位证书</span><br>        <span class="hljs-attr">homeCompany</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 上家公司</span><br>        <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 职称</span><br>        <span class="hljs-attr">resume</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 简历</span><br>        <span class="hljs-attr">isThereAnyCompetitionRestriction</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 有无竞业限制</span><br>        <span class="hljs-attr">proofOfDepartureOfFormerCompany</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 前公司离职证明</span><br>        <span class="hljs-attr">remarks</span>: <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">// 备注</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>在detail.vue组件中，注册并使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-tab-pane label=&quot;个人详情&quot;&gt;<br>           &lt;!-- 放置个人详情 --&gt;<br>           &lt;component :is=&quot;userComponent&quot; /&gt;<br>           &lt;!-- &lt;user-info /&gt; --&gt;<br> &lt;/el-tab-pane&gt;<br></code></pre></td></tr></table></figure>

<p>在以上代码中，我们使用了动态组件<strong>component</strong>，它通过 **<code>is</code><strong>属性来绑定需要显示在该位置的组件，is属性可以直接为</strong><code>注册组件</code>**的组件名称即可</p>
<h3 id="封装岗位组件"><a href="#封装岗位组件" class="headerlink" title="封装岗位组件"></a>封装岗位组件</h3><p>同理，封装岗位组件</p>
<p><strong>封装岗位组件</strong>  <strong><code>src/views/employee/components/job-info.vue</code></strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>&lt;div class=&quot;job-info&quot;&gt;<br>    &lt;!-- 基础信息 --&gt;<br>    &lt;el-form label-width=&quot;220px&quot;&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;基础信息&lt;/div&gt;<br>        &lt;el-form-item label=&quot;岗位&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.post&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;!-- &lt;el-form-item label=&quot;转正日期&quot;&gt;<br>          &lt;el-date-picker<br>            v-model=&quot;formData.dateOfCorrection&quot;<br>            type=&quot;date&quot;<br>            placeholder=&quot;选择日期&quot;<br>            value-format=&quot;yyyy-MM-dd&quot;<br>          /&gt;<br>        &lt;/el-form-item&gt; --&gt;<br>        &lt;el-form-item label=&quot;转正状态&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.stateOfCorrection&quot; placeholder=&quot;请选择&quot; disabled&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.stateOfCorrection&quot;<br>              :key=&quot;item.value&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;职级&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.rank&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;转正评价&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.correctionEvaluation&quot; type=&quot;textarea&quot; placeholder=&quot;1-300位字符&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;汇报对象&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.reportId&quot; filterable placeholder=&quot;请选择&quot; class=&quot;inputW&quot;&gt;<br>            &lt;el-option v-for=&quot;item in depts&quot; :key=&quot;item.id&quot; :label=&quot;item.username&quot; :value=&quot;item.id&quot; /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;HRBP&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.hrbp&quot; filterable placeholder=&quot;请选择&quot; class=&quot;inputW&quot;&gt;<br>            &lt;el-option v-for=&quot;item in depts&quot; :key=&quot;item.id&quot; :label=&quot;item.username&quot; :value=&quot;item.id&quot; class=&quot;inputW&quot; /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item class=&quot;formInfo&quot; label=&quot;调整司龄(天)：&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.adjustmentAgedays&quot; type=&quot;number&quot; placeholder=&quot;请输入&quot; class=&quot;inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;首次参加工作时间&quot;&gt;<br>          &lt;el-date-picker<br>            v-model=&quot;formData.workingTimeForTheFirstTime&quot;<br>            type=&quot;date&quot;<br>            placeholder=&quot;选择日期&quot;<br>            value-format=&quot;yyyy-MM-dd&quot;<br>          /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;调整工龄&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.adjustmentOfLengthOfService&quot; placeholder=&quot;0.00年&quot; class=&quot;inputW&quot; disabled /&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/div&gt;<br>      &lt;!-- 合同信息 --&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;合同信息&lt;/div&gt;<br>        &lt;el-form-item class=&quot;formInfo&quot; label=&quot;首次合同开始时间：&quot;&gt;<br>          &lt;el-date-picker<br>            v-model=&quot;formData.initialContractStartTime&quot;<br>            type=&quot;date&quot;<br>            placeholder=&quot;选择日期&quot;<br>            value-format=&quot;yyyy-MM-dd&quot;<br>          /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;首次合同结束时间&quot;&gt;<br>          &lt;el-date-picker<br>            v-model=&quot;formData.firstContractTerminationTime&quot;<br>            type=&quot;date&quot;<br>            placeholder=&quot;选择日期&quot;<br>            value-format=&quot;yyyy-MM-dd&quot;<br>          /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;现合同开始时间&quot;&gt;<br>          &lt;el-date-picker<br>            v-model=&quot;formData.currentContractStartTime&quot;<br>            type=&quot;date&quot;<br>            placeholder=&quot;选择日期&quot;<br>            value-format=&quot;yyyy-MM-dd&quot;<br>          /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;现合同结束时间&quot;&gt;<br>          &lt;el-date-picker<br>            v-model=&quot;formData.closingTimeOfCurrentContract	&quot;<br>            type=&quot;date&quot;<br>            placeholder=&quot;选择日期&quot;<br>            value-format=&quot;yyyy-MM-dd&quot;<br>          /&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;合同期限&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.contractPeriod&quot; class=&quot;filter-item&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.contractPeriod&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;续签次数&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.renewalNumber&quot; class=&quot;filter-item&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.renewalCount&quot;<br>              :key=&quot;item.id&quot;<br>              :label=&quot;item.value&quot;<br>              :value=&quot;item.id&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/div&gt;<br>      &lt;!-- 招聘信息 --&gt;<br>      &lt;div class=&quot;block&quot;&gt;<br>        &lt;div class=&quot;title&quot;&gt;招聘信息&lt;/div&gt;<br>        &lt;el-form-item label=&quot;其他招聘渠道&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.otherRecruitmentChannels&quot; placeholder=&quot;请选择&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.resumeSource&quot;<br>              :key=&quot;item.id&quot;<br>              :label=&quot;item.value&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;招聘渠道&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.recruitmentChannels&quot; placeholder=&quot;请选择&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.resumeSource&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;社招/校招&quot;&gt;<br>          &lt;el-select v-model=&quot;formData.socialRecruitment&quot; placeholder=&quot;请选择&quot;&gt;<br>            &lt;el-option<br>              v-for=&quot;item in EmployeeEnum.hireSourceType&quot;<br>              :key=&quot;item.value&quot;<br>              :label=&quot;item.label&quot;<br>              :value=&quot;item.value&quot;<br>            /&gt;<br>          &lt;/el-select&gt;<br>        &lt;/el-form-item&gt;<br>        &lt;el-form-item label=&quot;推荐企业/人&quot;&gt;<br>          &lt;el-input v-model=&quot;formData.recommenderBusinessPeople&quot; placeholder=&quot;请输入&quot; class=&quot;infoPosition inputW&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/div&gt;<br>      &lt;!-- 从业信息 --&gt;<br>      &lt;el-form-item&gt;<br>        &lt;el-button type=&quot;primary&quot; @click=&quot;saveJob&quot;&gt;保存更新&lt;/el-button&gt;<br>        &lt;el-button @click=&quot;$router.back()&quot;&gt;返回&lt;/el-button&gt;<br>      &lt;/el-form-item&gt;<br>    &lt;/el-form&gt;<br>  &lt;/div&gt;<br><br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<p><strong>定义岗位数据</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">EmployeeEnum</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/constant/employees&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">userId</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">$route</span>.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>,<br>      <span class="hljs-attr">depts</span>: [],<br>      <span class="hljs-title class_">EmployeeEnum</span>,<br>      <span class="hljs-attr">formData</span>: &#123;<br>        <span class="hljs-attr">adjustmentAgedays</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 调整司龄天</span><br>        <span class="hljs-attr">adjustmentOfLengthOfService</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 调整工龄天</span><br>        <span class="hljs-attr">closingTimeOfCurrentContract</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 现合同结束时间</span><br>        <span class="hljs-attr">companyId</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 公司ID</span><br>        <span class="hljs-attr">contractDocuments</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 合同文件</span><br>        <span class="hljs-attr">contractPeriod</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 合同期限</span><br>        <span class="hljs-attr">correctionEvaluation</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">//  转正评价</span><br>        <span class="hljs-attr">currentContractStartTime</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 现合同开始时间</span><br>        <span class="hljs-attr">firstContractTerminationTime</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 首次合同结束时间</span><br>        <span class="hljs-attr">hrbp</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// HRBP</span><br>        <span class="hljs-attr">initialContractStartTime</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 首次合同开始时间</span><br>        <span class="hljs-attr">otherRecruitmentChannels</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 其他招聘渠道</span><br>        <span class="hljs-attr">post</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 岗位</span><br>        <span class="hljs-attr">rank</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// 职级</span><br>        <span class="hljs-attr">recommenderBusinessPeople</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 推荐企业人</span><br>        <span class="hljs-attr">recruitmentChannels</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 招聘渠道</span><br>        <span class="hljs-attr">renewalNumber</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 续签次数</span><br>        <span class="hljs-attr">reportId</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 汇报对象</span><br>        <span class="hljs-attr">reportName</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">// 汇报对象</span><br>        <span class="hljs-attr">socialRecruitment</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 社招校招</span><br>        <span class="hljs-attr">stateOfCorrection</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 转正状态</span><br>        <span class="hljs-attr">taxableCity</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 纳税城市</span><br>        <span class="hljs-attr">userId</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 员工ID</span><br>        <span class="hljs-attr">workMailbox</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 工作邮箱</span><br>        <span class="hljs-attr">workingCity</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 工作城市</span><br>        <span class="hljs-attr">workingTimeForTheFirstTime</span>: <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">// 首次参加工作时间</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>在detail.vue组件中，注册并使用</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-tab-pane label=&quot;岗位详情&quot;&gt;<br>           &lt;!-- 放置岗位详情 --&gt;<br>           &lt;component :is=&quot;JobInfo&quot; /&gt;<br> &lt;/el-tab-pane&gt;<br></code></pre></td></tr></table></figure>

<p>**<code>本节任务</code>**：完成个人组件和岗位组件封装</p>
<h2 id="员工个人信息和岗位信息-读取-保存"><a href="#员工个人信息和岗位信息-读取-保存" class="headerlink" title="员工个人信息和岗位信息-读取-保存"></a>员工个人信息和岗位信息-读取-保存</h2><p>**<code>目标</code>**：实现个人信息的岗位信息的读取和校验，保存</p>
<h3 id="读取个人保存个人信息"><a href="#读取个人保存个人信息" class="headerlink" title="读取个人保存个人信息"></a>读取个人保存个人信息</h3><blockquote>
<p>这个环节里面大部分都是繁杂的属性和重复的过程，所以该环节直接将过程代码拷贝到项目中即可</p>
</blockquote>
<p>封装 <strong>读取个人信息</strong> <strong>保存个人信息</strong>  <strong>读取岗位信息</strong> <strong>保存岗位信息</strong>  </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/** *</span><br><span class="hljs-comment"> *  读取用户详情的基础信息</span><br><span class="hljs-comment"> * **/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getPersonalDetail</span>(<span class="hljs-params">id</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/employees/<span class="hljs-subst">$&#123;id&#125;</span>/personalInfo`</span><br>  &#125;)<br>&#125;<br><br><span class="hljs-comment">/** *</span><br><span class="hljs-comment"> *  更新用户详情的基础信息</span><br><span class="hljs-comment"> * **/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updatePersonal</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/employees/<span class="hljs-subst">$&#123;data.userId&#125;</span>/personalInfo`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;put&#x27;</span>,<br>    data<br>  &#125;)<br>&#125;<br><br><br><span class="hljs-comment">/** **</span><br><span class="hljs-comment"> * 获取用户的岗位信息</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * ****/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">getJobDetail</span>(<span class="hljs-params">id</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/employees/<span class="hljs-subst">$&#123;id&#125;</span>/jobs`</span><br>  &#125;)<br>&#125;<br><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * 保存岗位信息</span><br><span class="hljs-comment"> * ****/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateJob</span>(<span class="hljs-params">data</span>) &#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-title function_">request</span>(&#123;<br>    <span class="hljs-attr">url</span>: <span class="hljs-string">`/employees/<span class="hljs-subst">$&#123;data.userId&#125;</span>/jobs`</span>,<br>    <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;put&#x27;</span>,<br>    data<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>读取，保存个人信息</strong>  <strong><code>user-info</code></strong>  需要注意：这里的保存实际上分成了两个接口，这是接口的设计，我们只能遵守</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; getPersonalDetail, updatePersonal, saveUserDetailById &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/employees&#x27;</span><br><span class="hljs-keyword">import</span> &#123; getUserDetailById &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/user&#x27;</span><br> <span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPersonalDetail</span>()<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUserDetailById</span>()<br>  &#125;,<br>  <span class="hljs-attr">methods</span>: &#123;<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getPersonalDetail</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPersonalDetail</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span>) <span class="hljs-comment">// 获取员工数据</span><br>    &#125;,<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">savePersonal</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">updatePersonal</span>(&#123; ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>, <span class="hljs-attr">id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span> &#125;)<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;保存成功&#x27;</span>)<br>    &#125;,<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">saveUser</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">//  调用父组件</span><br>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">saveUserDetailById</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span>)<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;保存成功&#x27;</span>)<br>    &#125;,<br>    <span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserDetailById</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserDetailById</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span>)<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<h3 id="读取保存岗位信息"><a href="#读取保存岗位信息" class="headerlink" title="读取保存岗位信息"></a>读取保存岗位信息</h3><p><strong>读取，保存岗位信息</strong>  <strong><code>job-info</code></strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; getEmployeeSimple, updateJob, getJobDetail &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/api/employees&#x27;</span><br><br><span class="hljs-title function_">created</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getJobDetail</span>()<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getEmployeeSimple</span>()<br>&#125;,<br><span class="hljs-attr">methods</span>: &#123;<br>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getJobDetail</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getJobDetail</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span>)<br>  &#125;,<br>  <span class="hljs-comment">// 获取员工列表</span><br>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getEmployeeSimple</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">depts</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getEmployeeSimple</span>()<br>  &#125;,<br>  <span class="hljs-comment">// 保存岗位信息</span><br>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">saveJob</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">updateJob</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;保存岗位信息成功&#x27;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 实现个人信息的岗位信息的读取和校验，保存</p>
<h2 id="配置腾讯云Cos"><a href="#配置腾讯云Cos" class="headerlink" title="配置腾讯云Cos"></a>配置腾讯云Cos</h2><p>**<code>目标</code>**： 配置一个腾讯云cos</p>
<blockquote>
<p>由于上课的开发的特殊性，我们不希望把所有的图片都上传到我们自己的官方服务器上，这里我们可以采用一个腾讯云的图片方案</p>
</blockquote>
<p><img src="http://image.zhangyc.top/img/image-20200805200831035.png" srcset="/img/loading.gif" lazyload alt="image-20200805200831035"></p>
<blockquote>
<p>上边图的意思就是说，我们找一个可以免费上传图片的服务器，帮我们**<code>代管图片</code><strong>，我们在自己的数据库里只保存一个地址就行， 这其实也是很多项目的处理方案，会有一个</strong><code>公共的文件服务器</code>**</p>
</blockquote>
<p>第一步，我们必须先拥有一个<a target="_blank" rel="noopener" href="https://cloud.tencent.com/login?s_url=https://console.cloud.tencent.com/">腾迅云</a>的开发者账号(<strong>小心腾讯云的广告电话</strong>)</p>
<blockquote>
<p>请按照腾讯云的注册方式，注册自己的账号</p>
</blockquote>
<p>第二步，实名认证</p>
<blockquote>
<p>选择个人账户</p>
</blockquote>
<p><img src="http://image.zhangyc.top/img/image-20200805201013078.png" srcset="/img/loading.gif" lazyload alt="image-20200805201013078"></p>
<p><strong>填写个人身份信息</strong></p>
<p><img src="http://image.zhangyc.top/img/image-20200805201230001.png" srcset="/img/loading.gif" lazyload alt="image-20200805201230001"></p>
<p>下一步，扫描二维码授权</p>
<p><img src="http://image.zhangyc.top/img/image-20200805201318977.png" srcset="/img/loading.gif" lazyload alt="image-20200805201318977"></p>
<p><strong>手机端授权</strong></p>
<p><img src="http://image.zhangyc.top/img/image-20200805201422567.png" srcset="/img/loading.gif" lazyload alt="image-20200805201422567"></p>
<p>点击<strong>领取免费产品</strong></p>
<p><img src="http://image.zhangyc.top/img/image-20200805201513338.png" srcset="/img/loading.gif" lazyload alt="image-20200805201513338"></p>
<p><strong>选择对象存储COS</strong></p>
<p><img src="http://image.zhangyc.top/img/image-20200805201750662.png" srcset="/img/loading.gif" lazyload alt="image-20200805201559233"></p>
<blockquote>
<p>我们免费拥有**<code>6个月的50G流量</code>**的对象存储空间使用权限，足够我们上传用户头像的使用了</p>
</blockquote>
<p><strong>点击0元试用，开通服务</strong></p>
<p><img src="http://image.zhangyc.top/img/image-20200805201559233.png" srcset="/img/loading.gif" lazyload alt="image-20200805201750662"></p>
<p>到这一步，账号的部分就操作完毕，接下来，我们需要来创建一个存储图片的存储桶</p>
<p>登录 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/cos5">对象存储控制台</a> ，<a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/13309">创建存储桶</a>。设置存储桶的权限为 <strong><code>公有读，私有写</code></strong></p>
<p><img src="http://image.zhangyc.top/img/image-20200806135409338.png" srcset="/img/loading.gif" lazyload alt="image-20200806135409338"></p>
<p><img src="http://image.zhangyc.top/img/image-20200916231600661.png" srcset="/img/loading.gif" lazyload alt="image-20200916231600661"></p>
<p>设置cors规则</p>
<p><img src="http://image.zhangyc.top/img/image-20200916231949174.png" srcset="/img/loading.gif" lazyload alt="image-20200916231949174"></p>
<p>AllowHeader 需配成<code>*</code>，如下图所示。</p>
<p><img src="http://image.zhangyc.top/img/image-20200805211749522.png" srcset="/img/loading.gif" lazyload alt="image-20200805211749522"></p>
<blockquote>
<p>因为我们本身没有域名，所以这里设置成**<code>*</code>**，仅限于测试，正式环境的话，这里需要配置真实的域名地址</p>
</blockquote>
<p>到这里，我们的腾讯云存储桶就设置好了。</p>
<h2 id="封装上传图片组件-上传组件需求分析"><a href="#封装上传图片组件-上传组件需求分析" class="headerlink" title="封装上传图片组件-上传组件需求分析"></a>封装上传图片组件-上传组件需求分析</h2><p><strong><code>目标</code></strong> 梳理整个的上传过程</p>
<p><strong>初始化cos对象参数</strong></p>
<table>
<thead>
<tr>
<th align="left">名称</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">SecretId</td>
<td align="left">开发者拥有的项目身份识别 ID，用以身份认证，可在 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">API 密钥管理</a> 页面获取</td>
</tr>
<tr>
<td align="left">SecretKey</td>
<td align="left">开发者拥有的项目身份密钥，可在 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">API 密钥管理</a> 页面获取</td>
</tr>
</tbody></table>
<blockquote>
<p>注意，上述的参数我们在本次开发过程中，直接将参数放置在前端代码中存储，但是腾讯云本身是不建议这么做的，因为**<code>敏感信息</code>**放在前端很容易被捕获，由于我们本次是测试研发，所以这个过程可以忽略</p>
<p>正确的做法应该是，通过网站调用接口换取敏感信息</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/11459">相关文档</a></p>
<p>实例化 上传sdk</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> cos = <span class="hljs-keyword">new</span> <span class="hljs-title function_">COS</span>(&#123;<br>    <span class="hljs-title class_">SecretId</span>: <span class="hljs-string">&#x27;COS_SECRETID&#x27;</span>, <span class="hljs-comment">// 身份识别 ID</span><br>    <span class="hljs-title class_">SecretKey</span>: <span class="hljs-string">&#x27;COS_SECRETKEY&#x27;</span>, <span class="hljs-comment">// 身份密钥</span><br>&#125;);<br></code></pre></td></tr></table></figure>

<blockquote>
<p>到目前为止，我们上传图片准备的内容就已经OK，接下来，我们在**<code>src/componets</code>** 新建一个**<code>ImageUpload</code>** 组件</p>
</blockquote>
<p>该组件需要满足什么要求呢？</p>
<ol>
<li>可以显示传入的图片地址</li>
<li>可以删除传入的图片地址</li>
<li>可以上传图片到云服务器</li>
<li>上传到腾讯云之后，可以返回图片地址，显示  </li>
<li>上传成功之后，可以回调成功函数</li>
</ol>
<p>这个上传组件简单吗？</p>
<p><strong><code>no ! ! !</code></strong></p>
<p>看似需求很明确，但是它真正的实现很复杂，我们通过一个图来看一下</p>
<p><img src="http://image.zhangyc.top/img/image-20200806174643390.png" srcset="/img/loading.gif" lazyload alt="image-20200806174643390"></p>
<p>从上图中，我们可以看到，实际上是有两种场景的，本地场景和已经上传的场景</p>
<p>下个章节，针对这个场景我们进行开发</p>
<h2 id="封装上传组件-代码实现"><a href="#封装上传组件-代码实现" class="headerlink" title="封装上传组件-代码实现"></a>封装上传组件-代码实现</h2><p>**<code>目标</code>**实现上传组件的代码部分</p>
<blockquote>
<p>JavaScript SDK 需浏览器支持基本的 HTML5 特性（支持 IE10 以上浏览器），以便支持 ajax 上传文件和计算文件 MD5 值。</p>
</blockquote>
<h3 id="新建文件上传组件"><a href="#新建文件上传组件" class="headerlink" title="新建文件上传组件"></a>新建文件上传组件</h3><p><strong>安装JavaScript SDK</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ npm i cos-js-sdk-v5 --save<br></code></pre></td></tr></table></figure>

<p><strong>新建上传图片组件</strong> <strong><code>src/components/ImageUpload/index.vue</code></strong></p>
<blockquote>
<p>上传组件，我们可以沿用element的el-upload组件,并且采用照片墙的模式 <strong><code>list-type=&quot;picture-card&quot;</code></strong></p>
</blockquote>
<p><strong>放置el-upload组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;el-upload list-type=&quot;picture-card&quot;&gt;<br>     &lt;i class=&quot;el-icon-plus&quot; /&gt;<br>  &lt;/el-upload&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<p><strong>全局注册组件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">PageTools</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./PageTools&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">UploadExcel</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./UploadExcel&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">ImageUpload</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ImageUpload&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">install</span>(<span class="hljs-params">Vue</span>) &#123;<br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;PageTools&#x27;</span>, <span class="hljs-title class_">PageTools</span>) <span class="hljs-comment">// 注册工具栏组件</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;UploadExcel&#x27;</span>, <span class="hljs-title class_">UploadExcel</span>) <span class="hljs-comment">// 注册导入excel组件</span><br>    <span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;ImageUpload&#x27;</span>, <span class="hljs-title class_">ImageUpload</span>) <span class="hljs-comment">// 注册导入上传组件</span><br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<h3 id="点击图片进行预览"><a href="#点击图片进行预览" class="headerlink" title="点击图片进行预览"></a>点击图片进行预览</h3><p><strong>限定上传的图片数量和action</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;el-upload list-type=&quot;picture-card&quot; :limit=&quot;1&quot; action=&quot;#&quot;&gt;<br>  &lt;/el-upload&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>action为什么给#， 因为前面我们讲过了，我们要上传到腾讯云，需要自定义的上传方式,action给个#防止报错</p>
</blockquote>
<p><strong>预览</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">fileList</span>: [], <span class="hljs-comment">// 图片地址设置为数组 </span><br>      <span class="hljs-attr">showDialog</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 控制显示弹层</span><br>      <span class="hljs-attr">imgUrl</span>: <span class="hljs-string">&#x27;&#x27;</span><br>    &#125;<br>  &#125;,<br></code></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">   <span class="hljs-title function_">preview</span>(<span class="hljs-params">file</span>) &#123;<br>    <span class="hljs-comment">// 这里应该弹出一个层 层里是点击的图片地址</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imgUrl</span> = file.<span class="hljs-property">url</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">showDialog</span> = <span class="hljs-literal">true</span><br>&#125;,  <br></code></pre></td></tr></table></figure>

<p><strong>预览弹层</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-dialog title=&quot;图片&quot; :visible.sync=&quot;showDialog&quot;&gt;<br>    &lt;img :src=&quot;imgUrl&quot; style=&quot;width:100%&quot; alt=&quot;&quot;&gt;<br> &lt;/el-dialog&gt;<br></code></pre></td></tr></table></figure>

<h3 id="根据上传数量控制上传按钮"><a href="#根据上传数量控制上传按钮" class="headerlink" title="根据上传数量控制上传按钮"></a>根据上传数量控制上传按钮</h3><p><strong>控制上传显示</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">computed</span>: &#123;<br>   <span class="hljs-comment">// 设定一个计算属性 判断是否已经上传完了一张</span><br>   <span class="hljs-title function_">fileComputed</span>(<span class="hljs-params"></span>) &#123;<br>     <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">fileList</span>.<span class="hljs-property">length</span> === <span class="hljs-number">1</span><br>   &#125;<br> &#125;,<br></code></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs css"> &lt;el-upload<br>      :on-preview=<span class="hljs-string">&quot;preview&quot;</span><br>      :on-remove=<span class="hljs-string">&quot;handleRemove&quot;</span><br>      :on-change=<span class="hljs-string">&quot;changeFile&quot;</span><br>      :file-list=<span class="hljs-string">&quot;fileList&quot;</span><br>      list-type=<span class="hljs-string">&quot;picture-card&quot;</span><br>      action=<span class="hljs-string">&quot;#&quot;</span><br>      :limit=<span class="hljs-string">&quot;1&quot;</span><br>      :class=<span class="hljs-string">&quot;&#123;disabled: fileComputed &#125;&quot;</span><br>    &gt;<br><br>&lt;style&gt;<br>.disabled .el-upload--picture-card &#123;<br>  <span class="hljs-attribute">display</span>: none<br>&#125;<br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure>

<h3 id="删除图片和添加图片"><a href="#删除图片和添加图片" class="headerlink" title="删除图片和添加图片"></a>删除图片和添加图片</h3><p><strong>删除文件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">handleRemove</span>(<span class="hljs-params">file</span>) &#123;<br>    <span class="hljs-comment">// file是点击删除的文件</span><br>  <span class="hljs-comment">//   将原来的文件给排除掉了 剩下的就是最新的数组了</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fileList</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fileList</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">uid</span> !== file.<span class="hljs-property">uid</span>)<br>  &#125;,<br></code></pre></td></tr></table></figure>

<p><strong>添加文件</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 修改文件时触发</span><br><span class="hljs-comment">// 此时可以用fileList 因为该方法会进来很多遍 不能每次都去push</span><br><span class="hljs-comment">// fileList因为fileList参数是当前传进来的最新参数 我们只需要将其转化成数组即可 需要转化成一个新的数组</span><br><span class="hljs-comment">// [] =&gt; [...fileList] [] =&gt; fileList.map()</span><br><span class="hljs-comment">// 上传成功之后 还会进来 需要实现上传代码的逻辑 这里才会成功</span><br><span class="hljs-title function_">changeFile</span>(<span class="hljs-params">file, fileList</span>) &#123;<br>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">fileList</span> = fileList.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="上传之前检查"><a href="#上传之前检查" class="headerlink" title="上传之前检查"></a>上传之前检查</h3><blockquote>
<p>控制上传图片的类型和上传大小， 如果不满足条件 返回false上传就会停止</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">beforeUpload</span>(<span class="hljs-params">file</span>) &#123;<br>  <span class="hljs-comment">// 要开始做文件上传的检查了</span><br>  <span class="hljs-comment">// 文件类型 文件大小</span><br>  <span class="hljs-keyword">const</span> types = [<span class="hljs-string">&#x27;image/jpeg&#x27;</span>, <span class="hljs-string">&#x27;image/gif&#x27;</span>, <span class="hljs-string">&#x27;image/bmp&#x27;</span>, <span class="hljs-string">&#x27;image/png&#x27;</span>]<br>  <span class="hljs-keyword">if</span> (!types.<span class="hljs-title function_">includes</span>(file.<span class="hljs-property">type</span>)) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;上传图片只能是 JPG、GIF、BMP、PNG 格式!&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>  &#125;<br>  <span class="hljs-comment">//  检查大小</span><br>  <span class="hljs-keyword">const</span> maxSize = <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span><br>  <span class="hljs-keyword">if</span> (maxSize &lt; file.<span class="hljs-property">size</span>) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;图片大小最大不能超过5M&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="上传动作调用上传腾讯云"><a href="#上传动作调用上传腾讯云" class="headerlink" title="上传动作调用上传腾讯云"></a>上传动作调用上传腾讯云</h3><p><strong>上传动作为el-upload的http-request属性</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">:http-request=<span class="hljs-string">&quot;upload&quot;</span><br><br>   <span class="hljs-comment">// 自定义上传动作 有个参数 有个file对象，是我们需要上传到腾讯云服务器的内容</span><br>   <span class="hljs-title function_">upload</span>(<span class="hljs-params">params</span>) &#123;<br>     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(params.<span class="hljs-property">file</span>)<br>   &#125;<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>我们需要在该方法中，调用腾讯云的上传方法</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/436/35649#.E7.AE.80.E5.8D.95.E4.B8.8A.E4.BC.A0.E5.AF.B9.E8.B1.A1">腾讯云文档地址</a></p>
<p>身份ID和密钥可以通过腾讯云平台获取</p>
<p>登录 <a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/capi">访问管理控制台</a> ，获取您的项目 SecretId 和 SecretKey。</p>
<p><img src="http://image.zhangyc.top/img/image-20200805211539544.png" srcset="/img/loading.gif" lazyload alt="image-20200805211539544"></p>
<p>实现代码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 进行上传操作</span><br><span class="hljs-title function_">upload</span>(<span class="hljs-params">params</span>) &#123;<br><span class="hljs-comment">//   console.log(params.file)</span><br>  <span class="hljs-keyword">if</span> (params.<span class="hljs-property">file</span>) &#123;<br>    <span class="hljs-comment">// 执行上传操作</span><br>    cos.<span class="hljs-title function_">putObject</span>(&#123;<br>      <span class="hljs-title class_">Bucket</span>: <span class="hljs-string">&#x27;shuiruohanyu-106-1302806742&#x27;</span>, <span class="hljs-comment">// 存储桶</span><br>      <span class="hljs-title class_">Region</span>: <span class="hljs-string">&#x27;ap-beijing&#x27;</span>, <span class="hljs-comment">// 地域</span><br>      <span class="hljs-title class_">Key</span>: params.<span class="hljs-property">file</span>.<span class="hljs-property">name</span>, <span class="hljs-comment">// 文件名</span><br>      <span class="hljs-title class_">Body</span>: params.<span class="hljs-property">file</span>, <span class="hljs-comment">// 要上传的文件对象</span><br>      <span class="hljs-title class_">StorageClass</span>: <span class="hljs-string">&#x27;STANDARD&#x27;</span> <span class="hljs-comment">// 上传的模式类型 直接默认 标准模式即可</span><br>      <span class="hljs-comment">// 上传到腾讯云 =》 哪个存储桶 哪个地域的存储桶 文件  格式  名称 回调</span><br>    &#125;, <span class="hljs-keyword">function</span>(<span class="hljs-params">err, data</span>) &#123;<br>      <span class="hljs-comment">// data返回数据之后 应该如何处理</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err || data)<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="上传成功之后处理返回数据"><a href="#上传成功之后处理返回数据" class="headerlink" title="上传成功之后处理返回数据"></a>上传成功之后处理返回数据</h3><blockquote>
<p>如何处理返回成功的返回数据</p>
</blockquote>
<p>确定要上传记录id</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">beforeUpload</span>(<span class="hljs-params">file</span>) &#123;<br>    <span class="hljs-comment">//   先检查文件类型</span><br>    <span class="hljs-keyword">const</span> types = [<span class="hljs-string">&#x27;image/jpeg&#x27;</span>, <span class="hljs-string">&#x27;image/gif&#x27;</span>, <span class="hljs-string">&#x27;image/bmp&#x27;</span>, <span class="hljs-string">&#x27;image/png&#x27;</span>]<br>    <span class="hljs-keyword">if</span> (!types.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item === file.<span class="hljs-property">type</span>)) &#123;<br>      <span class="hljs-comment">//   如果不存在</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;上传图片只能是 JPG、GIF、BMP、PNG 格式!&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span> <span class="hljs-comment">// 上传终止</span><br>    &#125;<br>    <span class="hljs-comment">// 检查文件大小  5M 1M = 1024KB 1KB = 1024B</span><br>    <span class="hljs-keyword">const</span> maxSize = <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span><br>    <span class="hljs-keyword">if</span> (file.<span class="hljs-property">size</span> &gt; maxSize) &#123;<br>      <span class="hljs-comment">//   超过了限制的文件大小</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;上传的图片大小不能大于5M&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    &#125;<br>    <span class="hljs-comment">//   已经确定当前上传的就是当前的这个file了</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentFileUid</span> = file.<span class="hljs-property">uid</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span> <span class="hljs-comment">// 最后一定要return  true</span><br>  &#125;,<br></code></pre></td></tr></table></figure>

<blockquote>
<p>处理返回数据</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 进行上传操作</span><br><span class="hljs-title function_">upload</span>(<span class="hljs-params">params</span>) &#123;<br><span class="hljs-comment">//   console.log(params.file)</span><br>  <span class="hljs-keyword">if</span> (params.<span class="hljs-property">file</span>) &#123;<br>    <span class="hljs-comment">// 执行上传操作</span><br>    cos.<span class="hljs-title function_">putObject</span>(&#123;<br>      <span class="hljs-title class_">Bucket</span>: <span class="hljs-string">&#x27;shuiruohanyu-106-1302806742&#x27;</span>, <span class="hljs-comment">// 存储桶</span><br>      <span class="hljs-title class_">Region</span>: <span class="hljs-string">&#x27;ap-beijing&#x27;</span>, <span class="hljs-comment">// 地域</span><br>      <span class="hljs-title class_">Key</span>: params.<span class="hljs-property">file</span>.<span class="hljs-property">name</span>, <span class="hljs-comment">// 文件名</span><br>      <span class="hljs-title class_">Body</span>: params.<span class="hljs-property">file</span>, <span class="hljs-comment">// 要上传的文件对象</span><br>      <span class="hljs-title class_">StorageClass</span>: <span class="hljs-string">&#x27;STANDARD&#x27;</span> <span class="hljs-comment">// 上传的模式类型 直接默认 标准模式即可</span><br>      <span class="hljs-comment">// 上传到腾讯云 =》 哪个存储桶 哪个地域的存储桶 文件  格式  名称 回调</span><br>    &#125;, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> &#123;<br>      <span class="hljs-comment">// data返回数据之后 应该如何处理</span><br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err || data)<br>      <span class="hljs-comment">// data中有一个statusCode === 200 的时候说明上传成功</span><br>      <span class="hljs-keyword">if</span> (!err &amp;&amp; data.<span class="hljs-property">statusCode</span> === <span class="hljs-number">200</span>) &#123;<br>        <span class="hljs-comment">//   此时说明文件上传成功  要获取成功的返回地址</span><br>        <span class="hljs-comment">// fileList才能显示到上传组件上 此时我们要将fileList中的数据的url地址变成 现在上传成功的地址</span><br>        <span class="hljs-comment">// 目前虽然是一张图片 但是请注意 我们的fileList是一个数组</span><br>        <span class="hljs-comment">// 需要知道当前上传成功的是哪一张图片</span><br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fileList</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fileList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>          <span class="hljs-comment">// 去找谁的uid等于刚刚记录下来的id</span><br>          <span class="hljs-keyword">if</span> (item.<span class="hljs-property">uid</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">currentFileUid</span>) &#123;<br>            <span class="hljs-comment">// 将成功的地址赋值给原来的url属性</span><br>            <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;http://&#x27;</span> + data.<span class="hljs-property">Location</span>, <span class="hljs-attr">upload</span>: <span class="hljs-literal">true</span> &#125;<br>            <span class="hljs-comment">// upload 为true 表示这张图片已经上传完毕 这个属性要为我们后期应用的时候做标记</span><br>            <span class="hljs-comment">// 保存  =&gt; 图片有大有小 =&gt; 上传速度有快又慢 =&gt;要根据有没有upload这个标记来决定是否去保存</span><br>          &#125;<br>          <span class="hljs-keyword">return</span> item<br>        &#125;)<br>        <span class="hljs-comment">// 将上传成功的地址 回写到了fileList中 fileList变化  =》 upload组件 就会根据fileList的变化而去渲染视图</span><br>      &#125;<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>我们在fileList中设置了属性为upload为true的属性，表示该图片已经上传成功了，如果fileList还有upload不为true的数据，那就表示该图片还没有上传完毕</p>
</blockquote>
<h3 id="上传的进度条显示"><a href="#上传的进度条显示" class="headerlink" title="上传的进度条显示"></a>上传的进度条显示</h3><blockquote>
<p>为了再上传图片过程中显示进度条，我们可以使用element-ui的进度条显示当前的上传进度</p>
</blockquote>
<p><strong>放置进度条</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-progress v-if=&quot;showPercent&quot; style=&quot;width: 180px&quot; :percentage=&quot;percent&quot; /&gt;<br></code></pre></td></tr></table></figure>

<p><strong>通过腾讯云sdk监听上传进度</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">cos.<span class="hljs-title function_">putObject</span>(&#123;<br>         <span class="hljs-comment">// 配置</span><br>         <span class="hljs-title class_">Bucket</span>: <span class="hljs-string">&#x27;laogao-1302806742&#x27;</span>, <span class="hljs-comment">// 存储桶名称</span><br>         <span class="hljs-title class_">Region</span>: <span class="hljs-string">&#x27;ap-guangzhou&#x27;</span>, <span class="hljs-comment">// 存储桶地域</span><br>         <span class="hljs-title class_">Key</span>: params.<span class="hljs-property">file</span>.<span class="hljs-property">name</span>, <span class="hljs-comment">// 文件名作为key</span><br>         <span class="hljs-title class_">StorageClass</span>: <span class="hljs-string">&#x27;STANDARD&#x27;</span>, <span class="hljs-comment">// 此类写死</span><br>         <span class="hljs-title class_">Body</span>: params.<span class="hljs-property">file</span>, <span class="hljs-comment">// 将本地的文件赋值给腾讯云配置</span><br>         <span class="hljs-comment">// 进度条</span><br>         <span class="hljs-attr">onProgress</span>: <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> &#123;<br>           <span class="hljs-variable language_">this</span>.<span class="hljs-property">percent</span> = params.<span class="hljs-property">percent</span> * <span class="hljs-number">100</span><br>         &#125;<br>       &#125;<br></code></pre></td></tr></table></figure>

<p><strong>完整代码</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div&gt;<br>    &lt;!-- 放置一个上传组件 --&gt;<br>    &lt;!-- action这里不写上传地址 因为我们是调用腾讯云cos 不是一个地址可以搞定的 要用自定义的上传 --&gt;<br>    &lt;el-upload<br>      :on-preview=&quot;preview&quot;<br>      :on-remove=&quot;handleRemove&quot;<br>      :on-change=&quot;changeFile&quot;<br>      :before-upload=&quot;beforeUpload&quot;<br>      :file-list=&quot;fileList&quot;<br>      :http-request=&quot;upload&quot;<br>      list-type=&quot;picture-card&quot;<br>      action=&quot;#&quot;<br>      :limit=&quot;1&quot;<br>      :class=&quot;&#123;disabled: fileComputed &#125;&quot;<br>    &gt;<br>      &lt;i class=&quot;el-icon-plus&quot; /&gt;<br>    &lt;/el-upload&gt;<br>    &lt;!-- 进度条 --&gt;<br>    &lt;el-progress v-if=&quot;showPercent&quot; style=&quot;width: 180px&quot; :percentage=&quot;percent&quot; /&gt;<br>    &lt;!-- 放置一个弹层 --&gt;<br>    &lt;!-- sync修饰符自动将弹层关闭了 --&gt;<br>    &lt;el-dialog title=&quot;图片&quot; :visible.sync=&quot;showDialog&quot;&gt;<br>      &lt;img :src=&quot;imgUrl&quot; style=&quot;width:100%&quot; alt=&quot;&quot;&gt;<br>    &lt;/el-dialog&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>import COS from &#x27;cos-js-sdk-v5&#x27; // 引入腾讯云的包<br>// 需要实例化<br>const cos = new COS(&#123;<br>  SecretId: &#x27;AKID0mqfEWqlUzIbeSkGRL6c7ML6c0B93To9&#x27;,<br>  SecretKey: &#x27;JFwNZdeRF2iOp03FFsGNDm44vWFitmNF&#x27;<br>&#125;) // 实例化的包 已经具有了上传的能力 可以上传到该账号里面的存储桶了<br>export default &#123;<br>  data() &#123;<br>    return &#123;<br>      fileList: [],<br>      showDialog: false, // 控制图片的显示或者隐藏<br>      imgUrl: &#x27;&#x27;, // 存储点击的图片地址<br>      currentFileUid: &#x27;&#x27;, // 用一个变量 记住当前上传的图片id<br>      percent: 0,<br>      showPercent: false // 默认不显示进度条<br>    &#125;<br>  &#125;,<br>  computed: &#123;<br>    // 设定一个计算属性 判断是否已经上传完了一张<br>    fileComputed() &#123;<br>      return this.fileList.length === 1<br>    &#125;<br>  &#125;,<br>  methods: &#123;<br>    preview(file) &#123;<br>      // 这里应该弹出一个层 层里是点击的图片地址<br>      this.imgUrl = file.url<br>      this.showDialog = true<br>    &#125;,<br>    handleRemove(file) &#123;<br>      // file是点击删除的文件<br>    //   将原来的文件给排除掉了 剩下的就是最新的数组了<br>      this.fileList = this.fileList.filter(item =&gt; item.uid !== file.uid)<br>    &#125;,<br>    // 修改文件时触发<br>    // 此时可以用fileList 因为该方法会进来很多遍 不能每次都去push<br>    // fileList因为fileList参数是当前传进来的最新参数 我们只需要将其转化成数组即可 需要转化成一个新的数组<br>    // [] =&gt; [...fileList] [] =&gt; fileList.map()<br>    // 上传成功之后 还会进来 需要实现上传代码的逻辑 这里才会成功<br>    changeFile(file, fileList) &#123;<br>      this.fileList = fileList.map(item =&gt; item)<br>    &#125;,<br>    beforeUpload(file) &#123;<br>      // 要开始做文件上传的检查了<br>      // 文件类型 文件大小<br>      const types = [&#x27;image/jpeg&#x27;, &#x27;image/gif&#x27;, &#x27;image/bmp&#x27;, &#x27;image/png&#x27;]<br>      if (!types.includes(file.type)) &#123;<br>        this.$message.error(&#x27;上传图片只能是 JPG、GIF、BMP、PNG 格式!&#x27;)<br>        return false<br>      &#125;<br>      //  检查大小<br>      const maxSize = 5 * 1024 * 1024<br>      if (maxSize &lt; file.size) &#123;<br>        this.$message.error(&#x27;图片大小最大不能超过5M&#x27;)<br>        return false<br>      &#125;<br>      // file.uid<br>      this.currentFileUid = file.uid // 记住当前的uid<br>      this.showPercent = true<br>      return true<br>    &#125;,<br>    // 自定义上传动作 有个参数 有个file对象，是我们需要上传到腾讯云服务器的内容<br>    upload(params) &#123;<br>      if (params.file) &#123;<br>        //  上传文件到腾讯云<br>        cos.putObject(&#123;<br>          // 配置<br>          Bucket: &#x27;laogao-1302806742&#x27;, // 存储桶名称<br>          Region: &#x27;ap-guangzhou&#x27;, // 存储桶地域<br>          Key: params.file.name, // 文件名作为key<br>          StorageClass: &#x27;STANDARD&#x27;, // 此类写死<br>          Body: params.file, // 将本地的文件赋值给腾讯云配置<br>          // 进度条<br>          onProgress: (params) =&gt; &#123;<br>            this.percent = params.percent * 100<br>          &#125;<br>        &#125;, (err, data) =&gt; &#123;<br>          // 需要判断错误与成功<br>          if (!err &amp;&amp; data.statusCode === 200) &#123;<br>            // 如果没有失败表示成功了<br>            // 此时认为上传成功了<br>            // this.currentFileUid<br>            // 仍然有个小问题， 比如此时我们正在上传，但是调用了保存，保存在上传过程中进行，<br>            // 此时上传还没有完成  此时可以这样做 ： 给所有上传成功的图片 加一个属性 upload: true<br>            this.fileList = this.fileList.map(item =&gt; &#123;<br>              if (item.uid === this.currentFileUid) &#123;<br>                //   upload为true表示 该图片已经成功上传到服务器，地址已经是腾讯云的地址了  就不可以执行保存了<br>                return &#123; url: &#x27;http://&#x27; + data.Location, upload: true &#125; // 将本地的地址换成腾讯云地址<br>              &#125;<br>              return item<br>            &#125;)<br>            setTimeout(() =&gt; &#123;<br>              this.showPercent = false // 隐藏进度条<br>              this.percent = 0 // 进度归0<br>            &#125;, 2000)<br><br>            // 将腾讯云地址写入到fileList上 ，保存的时候 就可以从fileList中直接获取图片地址<br><br>            // 此时注意，我们应该记住 当前上传的是哪个图片  上传成功之后，将图片的地址赋值回去<br>          &#125;<br>        &#125;)<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br>&lt;/script&gt;<br><br>&lt;style&gt;<br>.disabled .el-upload--picture-card &#123;<br>  display: none<br>&#125;<br>&lt;/style&gt;<br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>上传动作中，用到了上个小节中，我们注册的腾讯云cos的**<code>存储桶名称</code><strong>和</strong><code>地域名称</code>**</p>
</blockquote>
<p>通过上面的代码，我们会发现，我们把上传之后的图片信息都给了**<code>fileList数据</code><strong>，那么在应用时，就可以直接获取该实例的</strong><code>fileList数据即可</code>**</p>
<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> 完成上传组件的封装</p>
<h2 id="在员工详情中应用上传组件"><a href="#在员工详情中应用上传组件" class="headerlink" title="在员工详情中应用上传组件"></a>在员工详情中应用上传组件</h2><p>**<code>目标</code>**：应用封装好的上传组件</p>
<h3 id="将员工的头像和证件照赋值给上传组件"><a href="#将员工的头像和证件照赋值给上传组件" class="headerlink" title="将员工的头像和证件照赋值给上传组件"></a>将员工的头像和证件照赋值给上传组件</h3><p>在**<code>user-info.vue</code>**中放置上传组件</p>
<p><strong>员工头像</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;!-- 员工照片 --&gt;<br>    &lt;el-row class=&quot;inline-info&quot;&gt;<br>      &lt;el-col :span=&quot;12&quot;&gt;<br>        &lt;el-form-item label=&quot;员工头像&quot;&gt;<br>          &lt;!-- 放置上传图片 --&gt;<br>          &lt;image-upload ref=&quot;staffPhoto&quot; /&gt;<br>        &lt;/el-form-item&gt;<br>      &lt;/el-col&gt;<br>    &lt;/el-row&gt;<br></code></pre></td></tr></table></figure>

<p><strong>读取时赋值头像</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 读取上半部分的内容</span><br>   <span class="hljs-keyword">async</span> <span class="hljs-title function_">getUserDetailById</span>(<span class="hljs-params"></span>) &#123;<br>     <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getUserDetailById</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span>)<br>     <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span>.<span class="hljs-property">staffPhoto</span>) &#123;<br>       <span class="hljs-comment">// 这里我们赋值，同时需要给赋值的地址一个标记 upload: true</span><br>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">staffPhoto</span>.<span class="hljs-property">fileList</span> = [&#123; <span class="hljs-attr">url</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span>.<span class="hljs-property">staffPhoto</span>, <span class="hljs-attr">upload</span>: <span class="hljs-literal">true</span> &#125;]<br>     &#125;<br>   &#125;,<br></code></pre></td></tr></table></figure>

<p><strong>员工证件照</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-form-item label=&quot;员工照片&quot;&gt;<br>        &lt;!-- 放置上传图片 --&gt;<br>        &lt;!-- ref不要重名 --&gt;<br>        &lt;image-upload ref=&quot;myStaffPhoto&quot; /&gt;<br>      &lt;/el-form-item&gt;<br></code></pre></td></tr></table></figure>

<p><strong>读取时赋值照片</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 读取下半部分内容</span><br>   <span class="hljs-keyword">async</span>  <span class="hljs-title function_">getPersonalDetail</span>(<span class="hljs-params"></span>) &#123;<br>     <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getPersonalDetail</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">userId</span>)<br>     <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">staffPhoto</span>) &#123;<br>       <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">myStaffPhoto</span>.<span class="hljs-property">fileList</span> = [&#123; <span class="hljs-attr">url</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>.<span class="hljs-property">staffPhoto</span>, <span class="hljs-attr">upload</span>: <span class="hljs-literal">true</span> &#125;]<br>     &#125;<br>   &#125;,<br></code></pre></td></tr></table></figure>

<h3 id="保存时处理头像和证件照的保存"><a href="#保存时处理头像和证件照的保存" class="headerlink" title="保存时处理头像和证件照的保存"></a>保存时处理头像和证件照的保存</h3><p><strong>当点击保存更新时，获取图片的内容</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span>  <span class="hljs-title function_">saveUser</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-comment">// 去读取 员工上传的头像</span><br>    <span class="hljs-keyword">const</span> fileList = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">staffPhoto</span>.<span class="hljs-property">fileList</span> <span class="hljs-comment">// 读取上传组件的数据</span><br>    <span class="hljs-keyword">if</span> (fileList.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> !item.<span class="hljs-property">upload</span>)) &#123;<br>      <span class="hljs-comment">//  如果此时去找 upload为false的图片 找到了说明 有图片还没有上传完成</span><br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">warning</span>(<span class="hljs-string">&#x27;您当前还有图片没有上传完成！&#x27;</span>)<br>      <span class="hljs-keyword">return</span><br>    &#125;<br>    <span class="hljs-comment">// 通过合并 得到一个新对象</span><br>    <span class="hljs-keyword">await</span> <span class="hljs-title function_">saveUserDetailById</span>(&#123; ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">userInfo</span>, <span class="hljs-attr">staffPhoto</span>: fileList &amp;&amp; fileList.<span class="hljs-property">length</span> ? fileList[<span class="hljs-number">0</span>].<span class="hljs-property">url</span> : <span class="hljs-string">&#x27;&#x27;</span> &#125;)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;保存基本信息成功&#x27;</span>)<br>  &#125;,<br></code></pre></td></tr></table></figure>

<blockquote>
<p>上面代码中，upload如果为true，表示该图片已经完成上传，以此来判断图片是否已经上传完成</p>
</blockquote>
<p><strong>保存时读取头像</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span> <span class="hljs-title function_">savePersonal</span>(<span class="hljs-params"></span>) &#123;<br>   <span class="hljs-keyword">const</span> fileList = <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">myStaffPhoto</span>.<span class="hljs-property">fileList</span><br>   <span class="hljs-keyword">if</span> (fileList.<span class="hljs-title function_">some</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> !item.<span class="hljs-property">upload</span>)) &#123;<br>     <span class="hljs-comment">//  如果此时去找 upload为false的图片 找到了说明 有图片还没有上传完成</span><br>     <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">warning</span>(<span class="hljs-string">&#x27;您当前还有图片没有上传完成！&#x27;</span>)<br>     <span class="hljs-keyword">return</span><br>   &#125;<br>   <span class="hljs-keyword">await</span> <span class="hljs-title function_">updatePersonal</span>(&#123; ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">formData</span>, <span class="hljs-attr">staffPhoto</span>: fileList &amp;&amp; fileList.<span class="hljs-property">length</span> ? fileList[<span class="hljs-number">0</span>].<span class="hljs-property">url</span> : <span class="hljs-string">&#x27;&#x27;</span> &#125;)<br>   <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;保存基础信息成功&#x27;</span>)<br> &#125;<br></code></pre></td></tr></table></figure>

<p><strong>提交代码</strong></p>
<p><strong><code>本节任务</code></strong> ： 在员工详情中应用上传组件</p>
<h2 id="员工列表显示图片"><a href="#员工列表显示图片" class="headerlink" title="员工列表显示图片"></a>员工列表显示图片</h2><p>**<code>目标</code>**：在员工列表中心显示图片</p>
<blockquote>
<p>员工的头像可以在列表项中添加一列来进行显示</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-table-column label=&quot;头像&quot; align=&quot;center&quot;&gt;<br>            &lt;template slot-scope=&quot;&#123;row&#125;&quot;&gt;<br>              &lt;img<br>                slot=&quot;reference&quot;<br>                v-imageerror=&quot;require(&#x27;@/assets/common/bigUserHeader.png&#x27;)&quot;<br>                :src=&quot;row.staffPhoto &quot;<br>                style=&quot;border-radius: 50%; width: 100px; height: 100px; padding: 10px&quot;<br>                alt=&quot;&quot;<br>              &gt;<br>            &lt;/template&gt;<br>&lt;/el-table-column&gt;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>我们尝试用之前的指令来处理图片的异常问题，但是发现只有两三张图片能显示</p>
</blockquote>
<p><img src="http://image.zhangyc.top/img/image-20201028172654637.png" srcset="/img/loading.gif" lazyload alt="image-20201028172654637"></p>
<blockquote>
<p>这是因为有的员工的头像的地址为空，给img赋值空的src不能触发错误事件，针对这一特点，我们需要对指令进行升级</p>
</blockquote>
<p>插入节点的钩子里面判断空， 然后在组件更新之后的钩子中同样判断空</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> imageerror = &#123;<br>  <span class="hljs-title function_">inserted</span>(<span class="hljs-params">dom, options</span>) &#123;<br>    <span class="hljs-comment">//   图片异常的逻辑</span><br>    <span class="hljs-comment">//  监听img标签的错误事件  因为图片加载失败 会触发  onerror事件</span><br>    dom.<span class="hljs-property">src</span> = dom.<span class="hljs-property">src</span> || options.<span class="hljs-property">value</span><br><br>    dom.<span class="hljs-property">onerror</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>      <span class="hljs-comment">// 图片失败  赋值一个默认的图片</span><br>      dom.<span class="hljs-property">src</span> = options.<span class="hljs-property">value</span><br>    &#125;<br>  &#125;,<br>  <span class="hljs-title function_">componentUpdated</span>(<span class="hljs-params">dom, options</span>) &#123;<br>    dom.<span class="hljs-property">src</span> = dom.<span class="hljs-property">src</span> || options.<span class="hljs-property">value</span><br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p>这样我们可以看到每个用户的头像了，如果没有头像则显示默认图片</p>
<p><img src="http://image.zhangyc.top/img/image-20201028173333103.png" srcset="/img/loading.gif" lazyload alt="image-20201028173333103"></p>
<p>**<code>任务</code>**：员工列表显示图片</p>
<h2 id="图片地址生成二维码"><a href="#图片地址生成二维码" class="headerlink" title="图片地址生成二维码"></a>图片地址生成二维码</h2><p><strong><code>目标</code></strong> 将图片地址生成二维码显示</p>
<blockquote>
<p>我们想完成这样一个功能，当我们拥有头像地址时，将头像地址生成一个二维码，用手机扫码来访问</p>
</blockquote>
<p>首先，需要安装生成二维码的插件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ npm i qrcode<br></code></pre></td></tr></table></figure>

<blockquote>
<p>qrcode的用法是</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">QrCode</span>.<span class="hljs-title function_">toCanvas</span>(dom, info)<br></code></pre></td></tr></table></figure>

<blockquote>
<p>dom为一个canvas的dom对象， info为转化二维码的信息</p>
</blockquote>
<p>我们尝试将canvas标签放到dialog的弹层中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-dialog title=&quot;二维码&quot; :visible.sync=&quot;showCodeDialog&quot; @opened=&quot;showQrCode&quot; @close=&quot;imgUrl=&#x27;&#x27;&quot;&gt;<br>  &lt;el-row type=&quot;flex&quot; justify=&quot;center&quot;&gt;<br>    &lt;canvas ref=&quot;myCanvas&quot; /&gt;<br>  &lt;/el-row&gt;<br>&lt;/el-dialog&gt;<br></code></pre></td></tr></table></figure>

<p>在点击员工的图片时，显示弹层，并将图片地址转化成二维码</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">showQrCode</span>(<span class="hljs-params">url</span>) &#123;<br>  <span class="hljs-comment">// url存在的情况下 才弹出层</span><br>  <span class="hljs-keyword">if</span> (url) &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">showCodeDialog</span> = <span class="hljs-literal">true</span> <span class="hljs-comment">// 数据更新了 但是我的弹层会立刻出现吗 ？页面的渲染是异步的！！！！</span><br>    <span class="hljs-comment">// 有一个方法可以在上一次数据更新完毕，页面渲染完毕之后</span><br>    <span class="hljs-variable language_">this</span>.$nextTick(<span class="hljs-function">() =&gt;</span> &#123;<br>      <span class="hljs-comment">// 此时可以确认已经有ref对象了</span><br>      <span class="hljs-title class_">QrCode</span>.<span class="hljs-title function_">toCanvas</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">myCanvas</span>, url) <span class="hljs-comment">// 将地址转化成二维码</span><br>      <span class="hljs-comment">// 如果转化的二维码后面信息 是一个地址的话 就会跳转到该地址 如果不是地址就会显示内容</span><br>    &#125;)<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$message</span>.<span class="hljs-title function_">warning</span>(<span class="hljs-string">&#x27;该用户还未上传头像&#x27;</span>)<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>

<p><img src="http://image.zhangyc.top/img/image-20201028180651472.png" srcset="/img/loading.gif" lazyload alt="image-20201028180651472"></p>
<h2 id="打印员工信息"><a href="#打印员工信息" class="headerlink" title="打印员工信息"></a>打印员工信息</h2><p><strong><code>目标</code></strong> 完成个人信息和工作信息的打印功能</p>
<h3 id="新建打印页面及路由"><a href="#新建打印页面及路由" class="headerlink" title="新建打印页面及路由"></a>新建打印页面及路由</h3><p><strong>创建页面组件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;template&gt;<br>  &lt;div class=&quot;dashboard-container&quot; id=&quot;myPrint&quot;&gt;<br>    &lt;div class=&quot;app-container&quot;&gt;<br>      &lt;el-card&gt;<br>        &lt;el-breadcrumb separator=&quot;/&quot; class=&quot;titInfo &quot;&gt;<br>          &lt;el-breadcrumb-item :to=&quot;&#123; path: &#x27;/&#x27; &#125;&quot;&gt;首页&lt;/el-breadcrumb-item&gt;<br>          &lt;el-breadcrumb-item&gt;<br>            &lt;router-link :to=&quot;&#123;&#x27;path&#x27;:&#x27;/employees&#x27;&#125;&quot;&gt;员工管理&lt;/router-link&gt;<br>          &lt;/el-breadcrumb-item&gt;<br>          &lt;el-breadcrumb-item&gt;打印&lt;/el-breadcrumb-item&gt;<br>        &lt;/el-breadcrumb&gt;<br>        &lt;div v-if=&quot;type === &#x27;personal&#x27;&quot;&gt;<br>          &lt;h2 class=&quot;centInfo&quot;&gt;员工信息表&lt;/h2&gt;<br>          &lt;table cellspacing=&quot;0&quot; width=&quot;100%&quot; class=&quot;tableList&quot;&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;基本信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th style=&quot;width:10%&quot;&gt;姓名&lt;/th&gt;<br>              &lt;td colspan=&quot;6&quot; style=&quot;width:80%&quot;&gt;&#123;&#123; formData.username &#125;&#125;&lt;/td&gt;<br>              &lt;td rowspan=&quot;5&quot; style=&quot;width:10%&quot;&gt;&lt;img style=&quot;width:155px;height:218px&quot; :src=&quot;formData.staffPhoto&quot;&gt;&lt;/td&gt;<br><br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;性别&lt;/th&gt;<br>              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.sex &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;手机&lt;/th&gt;<br>              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.mobile &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;出生日期&lt;/th&gt;<br>              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.dateOfBirth | formatDate &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;最高学历&lt;/th&gt;<br>              &lt;td colspan=&quot;6&quot;&gt;&#123;&#123; formData.theHighestDegreeOfEducation &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th style=&quot;width:10%&quot;&gt;是否可编辑&lt;/th&gt;<br>              &lt;td style=&quot;width:35%&quot;&gt;&#123;&#123; formData.isItEditable &#125;&#125;&lt;/td&gt;<br>              &lt;th style=&quot;width:10%&quot;&gt;是否隐藏号码&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot; style=&quot;width:45%&quot;&gt;&#123;&#123; formData.doYouHideNumbers &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;国家地区&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.nationalArea &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;护照号&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.passportNo &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;身份证号&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.idNumber &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;身份证照片&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.iDCardPhoto &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;籍贯&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.nativePlace &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;民族&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.nation &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;英文名&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.englishName &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;婚姻状况&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.maritalStatus &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;员工照片&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.staffPhoto &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;生日&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.birthday &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;属相&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.zodiac &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;年龄&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.age &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;星座&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.constellation &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;血型&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.bloodType &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;户籍所在地&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.domicile &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;政治面貌&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.politicalOutlook &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;入党时间&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.timeToJoinTheParty &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;存档机构&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.archivingOrganization &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;子女状态&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.stateOfChildren &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;子女有无商业保险&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.doChildrenHaveCommercialInsurance &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;有无违法违纪行为&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.isThereAnyViolationOfLawOrDiscipline &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;有无重大病史&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.areThereAnyMajorMedicalHistories &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;通讯信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;QQ&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.qQ &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;微信&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.weChat &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;居住证城市&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.residenceCardCity &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;居住证办理日期&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.dateOfResidencePermit &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;居住证截止日期&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.residencePermitDeadline &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;现居住地&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.placeOfResidence &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;通讯地址&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.postalAddress &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;联系手机&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.contactTheMobilePhone &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;个人邮箱&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.personalMailbox &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;紧急联系人&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.emergencyContact &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;紧急联系电话&lt;/th&gt;<br>              &lt;td colspan=&quot;7&quot;&gt;&#123;&#123; formData.emergencyContactNumber &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;账号信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;社保电脑号&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.socialSecurityComputerNumber &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;公积金账号&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.providentFundAccount &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;银行卡号&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.bankCardNumber &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;开户行&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.openingBank &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;教育信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;学历类型&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.educationalType &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;毕业学校&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.graduateSchool &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;入学时间&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.enrolmentTime &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;毕业时间&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.graduationTime &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;专业&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.major &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;毕业证书&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.graduationCertificate &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;学位证书&lt;/th&gt;<br>              &lt;td colspan=&quot;7&quot;&gt;&#123;&#123; formData.certificateOfAcademicDegree &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;8&quot; class=&quot;centInfo&quot;&gt;从业信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;上家公司&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.homeCompany &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;职称&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.title &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;简历&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.resume &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;有无竞业限制&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.isThereAnyCompetitionRestriction &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;前公司离职证明&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.proofOfDepartureOfFormerCompany &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;备注&lt;/th&gt;<br>              &lt;td colspan=&quot;5&quot;&gt;&#123;&#123; formData.remarks &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>          &lt;/table&gt;<br>          &lt;div class=&quot;foot&quot;&gt;签字：___________日期:___________&lt;/div&gt;<br>        &lt;/div&gt;<br>        &lt;div v-else&gt;<br>          &lt;h2 class=&quot;centInfo&quot;&gt;岗位信息表&lt;/h2&gt;<br>          &lt;table cellspacing=&quot;0&quot; width=&quot;100%&quot; class=&quot;tableList&quot;&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;4&quot; class=&quot;centInfo&quot;&gt;基本信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th style=&quot;width:10%&quot;&gt;姓名&lt;/th&gt;<br>              &lt;td style=&quot;width:40%&quot;&gt;&#123;&#123; formData.username &#125;&#125;&lt;/td&gt;<br>              &lt;th style=&quot;width:10%&quot;&gt;入职日期&lt;/th&gt;<br>              &lt;td style=&quot;width:40%&quot;&gt;&#123;&#123; formData.dateOfEntry &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;部门&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.departmentName &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;岗位&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.post &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;工作邮箱&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.workMailbox &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;工号&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.workNumber &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;转正日期&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.dateOfCorrection &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;转正状态&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.stateOfCorrection &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;职级&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.rank &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;汇报对象&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.reportName &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;HRBP&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.hRBP &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;聘用形式&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.formOfEmployment &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br><br>            &lt;tr&gt;<br>              &lt;th&gt;管理形式&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.formOfManagement &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;调整司龄&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.adjustmentAgedays &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;司龄&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.ageOfDivision &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;首次参加工作时间&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.workingTimeForTheFirstTime &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br><br>            &lt;tr&gt;<br>              &lt;th&gt;调整工龄天&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.adjustmentOfLengthOfService &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;工龄&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.workingYears &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;纳税城市&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.taxableCity &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;转正评价&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.correctionEvaluation &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;4&quot; class=&quot;centInfo&quot;&gt;合同信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;首次合同开始时间&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.initialContractStartTime &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;首次合同结束时间&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.firstContractTerminationTime &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;现合同开始时间&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.currentContractStartTime &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;现合同结束时间&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.closingTimeOfCurrentContract &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br><br>            &lt;tr&gt;<br>              &lt;th&gt;合同期限&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.contractPeriod &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;合同文件&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.contractDocuments &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;续签次数&lt;/th&gt;<br>              &lt;td colspan=&quot;3&quot;&gt;&#123;&#123; formData.renewalNumber &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr class=&quot;title&quot;&gt;<br>              &lt;td colspan=&quot;4&quot; class=&quot;centInfo&quot;&gt;招聘信息&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;其他招聘渠道&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.otherRecruitmentChannels &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;招聘渠道&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.recruitmentChannels &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>            &lt;tr&gt;<br>              &lt;th&gt;社招校招&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.socialRecruitment &#125;&#125;&lt;/td&gt;<br>              &lt;th&gt;推荐企业人&lt;/th&gt;<br>              &lt;td&gt;&#123;&#123; formData.recommenderBusinessPeople &#125;&#125;&lt;/td&gt;<br>            &lt;/tr&gt;<br>          &lt;/table&gt;<br>          &lt;div class=&quot;foot&quot;&gt;签字：___________日期:___________&lt;/div&gt;<br>        &lt;/div&gt;<br>      &lt;/el-card&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br><br>&lt;script&gt;<br>import &#123; getPersonalDetail, getJobDetail &#125; from &#x27;@/api/employees&#x27;<br>import &#123; getUserDetailById &#125; from &#x27;@/api/user&#x27;<br>export default &#123;<br>  data() &#123;<br>    return &#123;<br>      formData: &#123;&#125;,<br>      userId: this.$route.params.id,<br>      type: this.$route.query.type // 打印类型<br>    &#125;<br>  &#125;,<br>  // 创建完毕状态<br>  created() &#123;<br>    this.type === &#x27;personal&#x27; ? this.getPersonalDetail() : this.getJobDetail()<br>  &#125;,<br>  // 组件更新<br>  methods: &#123;<br>    async getPersonalDetail() &#123;<br>      this.formData = await getPersonalDetail(this.userId) // 获取个人基本信息<br>    &#125;,<br>    async getJobDetail() &#123;<br>      const userInfo = await getUserDetailById(this.userId)<br>      const jobInfo = await getJobDetail(this.userId) // 获取个人基本信息<br>      this.formData = &#123; ...userInfo, ...jobInfo &#125;<br>    &#125;<br>  &#125;<br>&#125;<br>&lt;/script&gt;<br><br>&lt;style lang=&quot;scss&quot;&gt;<br>.foot &#123;<br>  padding: 30px 0;<br>  text-align: right;<br>&#125;<br>&lt;/style&gt;<br><br><br></code></pre></td></tr></table></figure>

<blockquote>
<p>该页面内容实际上就是读取个人和详情的接口数据，根据传入的type类型决定显示个人还是岗位</p>
</blockquote>
<p>type为**<code>personal</code><strong>时显示个人，为</strong><code>job</code>**时显示岗位</p>
<p><strong>新建打印页面路由</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;print/:id&#x27;</span>, <span class="hljs-comment">// 二级默认路由</span><br>    <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">import</span>(<span class="hljs-string">&#x27;@/views/employees/print&#x27;</span>), <span class="hljs-comment">// 按需加载</span><br>    <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">meta</span>: &#123;<br>      <span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;打印&#x27;</span>, <span class="hljs-comment">// 标记当前路由规则的中文名称 后续在做左侧菜单时 使用</span><br>      <span class="hljs-attr">icon</span>: <span class="hljs-string">&#x27;people&#x27;</span><br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure>

<p>完成详情到打印的跳转</p>
<p><strong>个人</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;<br>           &lt;el-tooltip content=&quot;打印个人基本信息&quot;&gt;<br>               &lt;router-link :to=&quot;`/employees/print/$&#123;userId&#125;?type=personal`&quot;&gt;<br>                 &lt;i class=&quot;el-icon-printer&quot; /&gt;<br>               &lt;/router-link&gt;<br>            &lt;/el-tooltip&gt;<br> &lt;/el-row&gt;<br></code></pre></td></tr></table></figure>

<p><strong>岗位</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;<br>            &lt;el-tooltip content=&quot;打印岗位信息&quot;&gt;<br>              &lt;router-link :to=&quot;`/employees/print/$&#123;userId&#125;?type=job`&quot;&gt;<br>                &lt;i class=&quot;el-icon-printer&quot;  /&gt;<br>              &lt;/router-link&gt;<br>            &lt;/el-tooltip&gt;<br>  &lt;/el-row&gt;<br></code></pre></td></tr></table></figure>

<h3 id="利用vue-print-nb进行打印"><a href="#利用vue-print-nb进行打印" class="headerlink" title="利用vue-print-nb进行打印"></a>利用vue-print-nb进行打印</h3><p>首先，打印功能我们借助一个比较流行的插件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ npm i vue-print-nb<br></code></pre></td></tr></table></figure>

<blockquote>
<p>它的用法是 </p>
</blockquote>
<p>首先注册该插件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Print</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-print-nb&#x27;</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Print</span>);<br></code></pre></td></tr></table></figure>

<p>使用v-print指令的方式进行打印</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;el-row type=&quot;flex&quot; justify=&quot;end&quot;&gt;<br>        &lt;el-button v-print=&quot;printObj&quot; size=&quot;small&quot; type=&quot;primary&quot;&gt;打印&lt;/el-button&gt;<br> &lt;/el-row&gt;<br> printObj: &#123;<br>      id: &#x27;myPrint&#x27;<br> &#125;<br></code></pre></td></tr></table></figure>

<p>最终，我们看到的效果</p>
<p><img src="http://image.zhangyc.top/img/image-20200728013006535.png" srcset="/img/loading.gif" lazyload alt="image-20200728013006535"></p>
<p><strong>提交代码</strong></p>
<p>**<code>本节任务</code>**打印员工信息</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Vue-project/" class="category-chain-item">Vue-project</a>
  
  
    <span>></span>
    
  <a href="/categories/Vue-project/HumanResources/" class="category-chain-item">HumanResources</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>第八天 员工管理</div>
      <div>http://example.com/2022/10/08/Vue-project/human-resources/08-员工管理/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>John Doe</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2022年10月8日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/10/09/Vue-project/human-resources/09-%E6%9D%83%E9%99%90%E8%AE%BE%E8%AE%A1%E5%92%8C%E7%AE%A1%E7%90%86/" title="第九天 权限设计和管理">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">第九天 权限设计和管理</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10/07/Vue-project/human-resources/07-%E5%85%AC%E5%8F%B8%E5%92%8C%E8%A7%92%E8%89%B2/" title="第七天 建立公司角色页面的基本结构">
                        <span class="hidden-mobile">第七天 建立公司角色页面的基本结构</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
